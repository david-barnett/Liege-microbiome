<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.5.45" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

<meta name="author" content="David Barnett" />
<meta name="dcterms.date" content="2025-11-21" />

<title>Practical 1A - R fundamentals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<!-- htmldependencies:E3FAD763 -->


<link rel="stylesheet" href="../../.css/instructions.css" />
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <div id="quarto-toc-target"></div>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Practical 1A - R fundamentals</h1>
<p class="subtitle lead">Liege microbiome workshop</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Barnett </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 21, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction"><span class="header-section-number">1</span> Introduction ğŸ‘‹</a>
  <ul>
  <li><a href="#learning-goals" id="toc-learning-goals"><span class="header-section-number">1.1</span> Learning goals ğŸ§ </a></li>
  <li><a href="#getting-started" id="toc-getting-started"><span class="header-section-number">1.2</span> Getting started ğŸš€</a></li>
  <li><a href="#using-quarto" id="toc-using-quarto"><span class="header-section-number">1.3</span> Using Quarto ğŸ“</a>
  <ul>
  <li><a href="#write-some-notes" id="toc-write-some-notes"><strong>Write some notes:</strong></a></li>
  <li><a href="#write-and-run-code" id="toc-write-and-run-code"><strong>Write and run code:</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#load-r-packages" id="toc-load-r-packages"><span class="header-section-number">2</span> Load R packages ğŸ“¦</a></li>
  <li><a href="#reading-data" id="toc-reading-data"><span class="header-section-number">3</span> Reading data ğŸ“‚</a></li>
  <li><a href="#inspecting-data" id="toc-inspecting-data"><span class="header-section-number">4</span> Inspecting data</a>
  <ul>
  <li><a href="#look-at-the-tables" id="toc-look-at-the-tables"><span class="header-section-number">4.1</span> Look at the tables ğŸ‘€</a></li>
  <li><a href="#summarise" id="toc-summarise"><span class="header-section-number">4.2</span> Summarise ğŸ“‹</a></li>
  <li><a href="#visualise" id="toc-visualise"><span class="header-section-number">4.3</span> Visualise ğŸ“Š</a></li>
  </ul></li>
  <li><a href="#joining-dataframes" id="toc-joining-dataframes"><span class="header-section-number">5</span> Joining data ğŸŸ§+ï¸ğŸŸª</a></li>
  <li><a href="#mutating-data" id="toc-mutating-data"><span class="header-section-number">6</span> Mutating data ğŸ§¬?</a>
  <ul>
  <li><a href="#modify-and-assign" id="toc-modify-and-assign"><span class="header-section-number">6.1</span> Modify and assign</a></li>
  <li><a href="#temporary-or-persistent" id="toc-temporary-or-persistent"><span class="header-section-number">6.2</span> Temporary or persistent?</a></li>
  <li><a href="#more-mutation" id="toc-more-mutation"><span class="header-section-number">6.3</span> More mutation</a></li>
  </ul></li>
  <li><a href="#save-your-progress" id="toc-save-your-progress"><span class="header-section-number">7</span> Save your progress ğŸ’¾</a></li>
  <li><a href="#next" id="toc-next"><span class="header-section-number">8</span> Next! â©</a></li>
  <li><a href="#session-info" id="toc-session-info"><span class="header-section-number">9</span> Session info</a></li>
  </ul>
</nav>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1"><span class="header-section-number">1</span> Introduction ğŸ‘‹</h2>
<section id="learning-goals" class="level3" data-number="1.1">
<h3 data-number="1.1"><span class="header-section-number">1.1</span> Learning goals ğŸ§ </h3>
<ul>
<li>Using Quarto</li>
<li>Reading tabular data</li>
<li>Inspecting data</li>
<li>Joining data frames</li>
<li>Mutating data frames</li>
</ul>
</section>
<section id="getting-started" class="level3" data-number="1.2">
<h3 data-number="1.2"><span class="header-section-number">1.2</span> Getting started ğŸš€</h3>
<p>In this workshop we will use an online version of <a href="https://posit.co/download/rstudio-desktop/" target="_blank" title="RStudio is an application where you write and run R code">RStudio</a> - via <a href="https://posit.cloud/spaces/583413!" target="_blank" title="Posit Cloud provides a cloud server to run and share RStudio projects">posit.cloud</a></p>
<ol type="1">
<li><p><a href="https://posit.cloud/spaces/583413!" target="_blank">Sign up for a free posit.cloud account</a><br />
(use a GitHub or Google account if you already have one of these)</p></li>
<li><p>Check your email for a link to join the posit.cloud space for this course</p></li>
<li><p>Click on the <strong>Liege-microbiome</strong> project - this will start RStudio</p></li>
<li><p>Go to <strong>Files</strong> (look bottom right) &gt; click folder <code>practical-1</code> &gt; open file <code>practical-1A-notebook.qmd</code></p></li>
</ol>
</section>
<section id="using-quarto" class="level3" data-number="1.3">
<h3 data-number="1.3"><span class="header-section-number">1.3</span> Using Quarto ğŸ“</h3>
<p>We will write code and notes in <a href="https://r4ds.hadley.nz/quarto" target="_blank">Quarto</a> <code>.qmd</code> documents, e.g.Â <code>practical-1A-notebook.qmd</code></p>
<section id="write-some-notes" class="level4">
<h4><strong>Write some notes:</strong></h4>
<p>You can write normal text for notes, e.g.Â your intentions, hypotheses, observations, etc.</p>
<p>To edit your Quarto notebooks in RStudio you can use â€œ<a href="https://quarto.org/docs/visual-editor/" target="_blank">Visual</a>â€ editor mode, or the â€œSourceâ€ mode.</p>
<p><em>Toggle between modes at the top left. Visual editor is easier for beginners, but Source mode shows how the Quarto file truly looks (it only contains <a href="https://quarto.org/docs/authoring/markdown-basics.html" target="_blank" title="Markdown is plain text, with special characters to indicate headings, bold text, links etc">markdown</a> text, but RStudio adds formatting in Visual mode).</em></p>
</section>
<section id="write-and-run-code" class="level4">
<h4><strong>Write and run code:</strong></h4>
<p>You can write code and comments in â€œchunksâ€ - like the one below.</p>
<p>Run a chunk by clicking the green play button in the corner of the chunk</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a comment, because it starts with the # symbol</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;This line is code, try to run it!&quot;</span>) </span></code></pre></div>
</div>
<p>Insert a code chunk with <code>Ctrl</code>+<code>Alt</code>+<code>I</code> (Windows) or <code>Cmd</code>+<code>Option</code>+<code>I</code> (Mac).</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can also run code with keyboard shortcuts!</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Run this one line with Ctrl + Enter, or Cmd + Enter on Mac&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;or run a whole chunk with Ctrl/Cmd + SHIFT + Enter&quot;</span>)</span></code></pre></div>
</div>
<p>You can run all previous chunks by clicking the other button in the corner of the chunk.</p>
</section>
</section>
</section>
<section id="load-r-packages" class="level2" data-number="2">
<h2 data-number="2"><span class="header-section-number">2</span> Load R packages ğŸ“¦</h2>
<p>It is a good idea to load all the packages you need at the top of your notebook.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `readxl` is for reading data from Excel files</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `writexl` is for writing data to a new Excel file</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl) <span class="co"># we&#39;ll use this at the end</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the `here` package makes specifying file locations easier</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/david/Documents/git/R-projects/teaching/workshops/2024-Liege-microbiome</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `tidyverse` is a collection of several packages </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># (dplyr, ggplot2, and others)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.4     âœ” readr     2.1.5
âœ” forcats   1.0.0     âœ” stringr   1.5.1
âœ” ggplot2   3.5.1     âœ” tibble    3.2.1
âœ” lubridate 1.9.3     âœ” tidyr     1.3.1
âœ” purrr     1.0.2     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
</section>
<section id="reading-data" class="level2" data-number="3">
<h2 data-number="3"><span class="header-section-number">3</span> Reading data ğŸ“‚</h2>
<p>How do we read a table of data from a file, e.g.Â an Excel file?</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># give your objects short but informative names!</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="fu">here</span>(<span class="st">&quot;data/papa2012/papa2012_metadata.xlsx&quot;</span>), <span class="at">na =</span> <span class="st">&quot;NA&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>meds <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">&quot;data/papa2012/papa2012_metadata.xlsx&quot;</span>), <span class="at">sheet =</span> <span class="st">&quot;treatment&quot;</span>)</span></code></pre></div>
</div>
<div id="tip-paths" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
TipÂ 1: Projects and portable file paths
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>There are multiple ways to tell R where to find the data files for a project.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Projects + relative paths</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Absolute paths</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">setwd + relative paths</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>ğŸ‘ <strong>The best way</strong> ğŸ‘</p>
<ol type="1">
<li><p>For each data analysis project you do, create a separate folder for that project, and keep all relevant code and data inside that folder.</p></li>
<li><p>RStudio also offers additional convenient features for organisation with <a href="https://r4ds.hadley.nz/workflow-scripts.html#rstudio-projects" target="_blank" title="Section of R for Data Science book introducing RStudio projects">RStudio Projects</a>!</p></li>
<li><p>Using the R package called <code>here</code> you can easily specify the location of your data using file paths relative to the project folder. The <code>here</code> package offers one important function, also called <code>here()</code></p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this will work anywhere! (anywhere that the project folder is moved or copied)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="fu">here</span>(<span class="st">&quot;data/papa2012/papa2012_metadata.xlsx&quot;</span>), <span class="at">na =</span> <span class="st">&quot;NA&quot;</span>)</span></code></pre></div>
</div>
<p>This is reliable and portable! ğŸ¤© If you share the entire project folder with a collaborator (e.g.Â as a zip file or via github) then this code will work on their computer without needing any changes!</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>ğŸ˜ <strong>Easy but limiting</strong> ğŸ˜</p>
<ol type="1">
<li><p>An absolute path (also known as a full path) can be used to specify where a file is on your own computer.</p></li>
<li><p>This will work okay, but only if you never move your files, and never change computerâ€¦</p></li>
<li><p>Using absolute paths makes it <strong>inconvenient</strong> to share your project or work collaboratively. ğŸ™</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this works on my machine, but it won&#39;t work anywhere else!</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">&quot;/Users/david/Documents/teaching/workshops/Liege-microbiome/data/papa2012/papa2012_metadata.xlsx&quot;</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">na =</span> <span class="st">&quot;NA&quot;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>ğŸ¤· <strong>Commonly used but still problematic</strong> ğŸ¤·</p>
<ul>
<li>You can use paths relative to the <em>working directory</em> set with <code>setwd("/an/absolute/path/on/your/computer")</code>, BUT:</li>
</ul>
<ol type="1">
<li><p>setwd still uses an absolute path, so it is still not portable!</p></li>
<li><p>setwd does not work in notebooks, which reset working directory every chunk</p></li>
<li><p>Prof.Â Jenny Bryan might set your computer on fire! ğŸ–¥ï¸ğŸ”¥ (<a href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/" target="_blank">read why here</a>)</p></li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this works on my machine, but it won&#39;t work anywhere else!</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/Users/david/Documents/teaching/workshops/Liege-microbiome&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;data/papa2012/papa2012_metadata.xlsx&quot;</span>, <span class="at">na =</span> <span class="st">&quot;NA&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inspecting-data" class="level2" data-number="4">
<h2 data-number="4"><span class="header-section-number">4</span> Inspecting data</h2>
<section id="look-at-the-tables" class="level3" data-number="4.1">
<h3 data-number="4.1"><span class="header-section-number">4.1</span> Look at the tables ğŸ‘€</h3>
<p>Start by printing the metadata data frame, like this:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>meta</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 Ã— 10
   ID    sample case_control diagnosis activity active   gender ethnicity
   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    
 1 099A  099-AX Case         UC        severe   active   female White    
 2 199A  199-AX Control      Other     control  control  female Other    
 3 062B  062-BZ Case         CD        mild     active   male   White    
 4 194A  194-AZ Case         UC        mild     active   male   White    
 5 166A  166-AX Case         UC        severe   active   female Black    
 6 219A  219-AX Case         UC        inactive inactive female &lt;NA&gt;     
 7 132A  132-AX Case         CD        mild     active   female White    
 8 026A  026-AX Case         UC        mild     active   male   White    
 9 102A  102-AZ Control      Other     control  control  male   White    
10 140A  140-AX Control      Other     control  control  female White    
# â„¹ 80 more rows
# â„¹ 2 more variables: family_history &lt;chr&gt;, age_years &lt;dbl&gt;</code></pre>
</div>
</div>
<div id="tip-looking" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
TipÂ 2: What is (in) this object?
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">dataframes &amp; tibbles</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">vector classes?</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>A dataframe is the standard class of object for holding rectangular data (tables) in your R environment.</p>
<p>Columns of a dataframe can hold vectors of different classes, e.g.Â chr and int (characters and integers)</p>
<p>(In contrast, a matrix can only hold one type of data!)</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>example_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">alphabet =</span> LETTERS, <span class="at">numbers =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>)</span></code></pre></div>
</div>
<p>Try <code>View(example_df)</code> in the Console - but not in a Quarto doc chunk</p>
<p>A tibble is just a dataframe, but with a concise print format, useful!</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>example_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(example_df)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>example_tbl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26 Ã— 2
   alphabet numbers
   &lt;chr&gt;      &lt;int&gt;
 1 A              1
 2 B              2
 3 C              3
 4 D              4
 5 E              5
 6 F              6
 7 G              7
 8 H              8
 9 I              9
10 J             10
# â„¹ 16 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Each column in a dataframe/tibble can be on of the following types of vector object</p>
<ul>
<li><strong>numeric</strong>: real numbers, e.g., <code>c(7.5, -2.301, 0.666)</code>.</li>
<li><strong>integer</strong>: whole numbers, e.g., <code>c(9L, 4L, -123L)</code>.</li>
<li><strong>logical</strong>: Boolean values, e.g., <code>c(TRUE, FALSE)</code>.</li>
<li><strong>character</strong>: strings of text, e.g., <code>c("no", "yes", "unsure")</code>.</li>
<li><strong>factor</strong>: categories with fixed levels, e.g., <code>factor(c("no", "yes", "unsure"))</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta<span class="sc">$</span>family_history, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  fhx nofhx  &lt;NA&gt; 
   25    54    11 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta<span class="sc">$</span>age_years, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 24 
 2  3  5  1  2  5  5  4  6 10  6  9  7  7  4  4  5  3  1  1 </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="summarise" class="level3" data-number="4.2">
<h3 data-number="4.2"><span class="header-section-number">4.2</span> Summarise ğŸ“‹</h3>
<p>You can count the number of times a category occurs, similar to the table function.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">count</span>(diagnosis)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 2
  diagnosis     n
  &lt;chr&gt;     &lt;int&gt;
1 CD           23
2 Other        24
3 UC           43</code></pre>
</div>
</div>
<p>Or count combinations of categories.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">count</span>(family_history, diagnosis)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 Ã— 3
  family_history diagnosis     n
  &lt;chr&gt;          &lt;chr&gt;     &lt;int&gt;
1 fhx            CD            8
2 fhx            Other         4
3 fhx            UC           13
4 nofhx          CD           12
5 nofhx          Other        14
6 nofhx          UC           28
7 &lt;NA&gt;           CD            3
8 &lt;NA&gt;           Other         6
9 &lt;NA&gt;           UC            2</code></pre>
</div>
</div>
<p>Or compute other summary statistics.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">age_mean =</span> <span class="fu">mean</span>(age_years), <span class="at">age_sd =</span> <span class="fu">sd</span>(age_years))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 Ã— 2
  age_mean age_sd
     &lt;dbl&gt;  &lt;dbl&gt;
1     12.6   4.65</code></pre>
</div>
</div>
<p>Or compute grouped summary statistics</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">age_mean =</span> <span class="fu">mean</span>(age_years), <span class="at">age_sd =</span> <span class="fu">sd</span>(age_years), <span class="at">.by =</span> diagnosis)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 3
  diagnosis age_mean age_sd
  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 UC           13.8    4.26
2 Other         9.08   4.30
3 CD           14.1    3.84</code></pre>
</div>
</div>
</section>
<section id="visualise" class="level3" data-number="4.3">
<h3 data-number="4.3"><span class="header-section-number">4.3</span> Visualise ğŸ“Š</h3>
<p>Râ€™s base graphics can be used to quickly summarise data distributions.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Histogram</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Bar chart</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>meta<span class="sc">$</span>age_years <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">xlab =</span> <span class="st">&quot;Age&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="1200" /></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>meta<span class="sc">$</span>activity <span class="sc">%&gt;%</span> <span class="fu">table</span>() <span class="sc">%&gt;%</span> <span class="fu">barplot</span>(<span class="at">xlab =</span> <span class="st">&quot;Disease Activity&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="1200" /></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>ggplot2 is a popular and powerful plotting package.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Histogram</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Bar chart</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(meta) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(age_years), <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>case_control, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1200" /></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(meta) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> activity, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="1600" /></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tip-ggsave" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
TipÂ 3: <code>ggsave</code> to save your plots? ğŸ¦¸ğŸ“ŠğŸ’¾
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Viewing your plots in RStudio is okay for practice</li>
<li>But donâ€™t copy paste them to save them, as there is a much better way!</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign your plot to an R object</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>plot_practice_bars <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meta) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> activity, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practice bar chart&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a folder for figures</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">&quot;practical-1/figs&quot;</span>))</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the plot to a file, with ggsave</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> plot_practice_bars, </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="fu">here</span>(<span class="st">&quot;practical-1/figs/practice-barchart.png&quot;</span>),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<p><strong>Be sure to carefully adjust the sizing and resolution of your plots for your paper or presentation!</strong></p>
</div>
</div>
</div>
<div id="tip-fig-quarto" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
TipÂ 4: Sizing plots in Quarto reports ğŸ“ğŸ“ŠğŸ“„
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Again, viewing your plots in the RStudio is only okay for practice.</li>
<li>If youâ€™re using Quarto reports, you can specify figure size and resolution in each chunk</li>
</ul>
<p>e.g.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="sourceCode markdown cell-code"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 6</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 3</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(meta) +</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(aes(y = activity, fill = diagnosis)) +</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtitle(&quot;Practice bar chart&quot;) +</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="1200" /></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tip-ggplot" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
TipÂ 5: Become a ggplot2 wizard ğŸ§™
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We will use ggplot2 throughout much of this workshop.</p>
<p>It is a powerful and flexible tool, but it takes practice to learn the details.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Resources</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Example</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Links to good resources for learning ggplot2</p>
<ul>
<li><p><a href="https://r4ds.hadley.nz/visualize.html" target="_blank">R 4 Data Science book</a> - intro to plots in R</p></li>
<li><p><a href="https://r-graphics.org/" target="_blank">R Graphics Cookbook</a> - quick practical guide</p></li>
<li><p><a href="https://r-graph-gallery.com/" target="_blank">R graph gallery</a> - ideas and example code</p></li>
<li><p><a href="https://ggplot2.tidyverse.org/reference/index.html" target="_blank">ggplot2 website</a> - a reference manual</p></li>
<li><p><a href="https://ggplot2-book.org/" target="_blank">ggplot2 book</a> - for a thorough grounding</p></li>
<li><p><a href="https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/" target="_blank">Cedric Schererâ€™s blog</a> - tutorial/examples</p></li>
<li><p><a href="https://adv-r.hadley.nz/metaprogramming.html" target="_blank">Metaprogramming, Advanced R</a> - experts only ğŸ¤¯</p></li>
</ul>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># age boxplot</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>plot_list<span class="sc">$</span>box <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> case_control, <span class="at">x =</span> age_years)) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> case_control),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">staplewidth =</span> <span class="fl">0.5</span>, <span class="at">outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="fl">0.2</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.05</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Age Distributions&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>))</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_list$box</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co"># family history piechart</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>plot_list<span class="sc">$</span>pie <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> family_history)) <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">fhx =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">nofhx =</span> <span class="st">&quot;grey70&quot;</span>),</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, <span class="at">guide =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">I</span>(pi <span class="sc">/</span> <span class="dv">8</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.25</span>), <span class="at">label =</span> <span class="st">&quot;NA&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">I</span>(<span class="fl">0.9</span> <span class="sc">*</span> pi), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.25</span>), <span class="at">label =</span> <span class="st">&quot;No FHx&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">I</span>(<span class="fl">1.7</span> <span class="sc">*</span> pi), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.25</span>), <span class="at">label =</span> <span class="st">&quot;FHx&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;Family History&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_radial</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>, <span class="at">inner.radius =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag.location =</span> <span class="st">&quot;panel&quot;</span>, <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_list$pie</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a><span class="co"># activity barchart</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>plot_list<span class="sc">$</span>bar <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> diagnosis,</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">factor</span>(activity, <span class="fu">c</span>(<span class="st">&quot;severe&quot;</span>, <span class="st">&quot;moderate&quot;</span>, <span class="st">&quot;mild&quot;</span>, <span class="st">&quot;inactive&quot;</span>))</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;UC&quot;</span>, <span class="st">&quot;CD&quot;</span>)) <span class="sc">+</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Activity&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Reds&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Activity Level&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>),</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_list$bar</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a><span class="co"># assemble with patchwork</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> plot_list<span class="sc">$</span>box, <span class="at">C =</span> plot_list<span class="sc">$</span>bar,</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> plot_list<span class="sc">$</span>pie, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>,</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;AAC</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a><span class="st"> AAC</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a><span class="st"> BBC</span></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a><span class="st"> BBC</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a><span class="st"> BBC&quot;</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="1600" /></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="joining-dataframes" class="level2" data-number="5">
<h2 data-number="5"><span class="header-section-number">5</span> Joining data ğŸŸ§+ï¸ğŸŸª</h2>
<p>Often, your data are not all in one table. For example, there were two sheets of data in the metadata Excel file, which we stored in the dataframe objects <code>meta</code> and <code>meds</code></p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><strong>meta</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><strong>meds</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>The main dataframe <code>meta</code> contains most of the data about each patient:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>meta</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 Ã— 10
   ID    sample case_control diagnosis activity active   gender ethnicity
   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;    
 1 099A  099-AX Case         UC        severe   active   female White    
 2 199A  199-AX Control      Other     control  control  female Other    
 3 062B  062-BZ Case         CD        mild     active   male   White    
 4 194A  194-AZ Case         UC        mild     active   male   White    
 5 166A  166-AX Case         UC        severe   active   female Black    
 6 219A  219-AX Case         UC        inactive inactive female &lt;NA&gt;     
 7 132A  132-AX Case         CD        mild     active   female White    
 8 026A  026-AX Case         UC        mild     active   male   White    
 9 102A  102-AZ Control      Other     control  control  male   White    
10 140A  140-AX Control      Other     control  control  female White    
# â„¹ 80 more rows
# â„¹ 2 more variables: family_history &lt;chr&gt;, age_years &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>The second dataframe <code>meds</code> contains medications info for the IBD cases:</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>meds</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 67 Ã— 4
   ID    diagnosis immunosuppression_level medication     
   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                   &lt;chr&gt;          
 1 048A  UC        level0                  mesalamine only
 2 119A  UC        level0                  mesalamine only
 3 120D  UC        level0                  mesalamine only
 4 192A  UC        level0                  mesalamine only
 5 215A  UC        level0                  mesalamine only
 6 216A  UC        level0                  mesalamine only
 7 233A  CD        level0                  mesalamine only
 8 009A  UC        level1                  steroids       
 9 035A  UC        level1                  steroids       
10 038A  UC        level1                  steroids       
# â„¹ 57 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><code>dplyr</code> provides functions to â€œjoinâ€ dataframes together, using shared variables.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(meta, meds)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ID, diagnosis)`</code></pre>
</div>
</div>
<p>By default the join function will perform a â€œnaturalâ€ join using all shared variables. For greater control you can specify a â€œkeyâ€ variable, or set of variables, that should be used.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this should do the same thing as the natural join shown above</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(meta, meds, <span class="at">by =</span> <span class="fu">join_by</span>(ID, diagnosis))</span></code></pre></div>
</div>
<p>What happened with the Control group? (remember they were not present in <code>meds</code>!)</p>
<p>Inspect the <code>all_meta</code> dataframe to find out! e.g.Â <code>View(all_meta)</code></p>
<div id="tip-joins" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
TipÂ 6: Learn the ways of the join ğŸª„
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A natural left join is the most common join you will need.</p>
<p><a href="https://r4ds.hadley.nz/diagrams/join/left.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="https://r4ds.hadley.nz/diagrams/join/left.png" class="img-fluid" width="500" /></a></p>
<p>But there are many other useful possibilities, e.g.</p>
<p><a href="https://r4ds.hadley.nz/diagrams/join/venn.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="https://r4ds.hadley.nz/diagrams/join/venn.png" class="img-fluid" width="500" /></a></p>
<p>Learn more at:</p>
<ul>
<li>This R4DS <a href="https://r4ds.hadley.nz/joins" target="_blank">online book chapter</a></li>
<li>This dplyr <a href="https://dplyr.tidyverse.org/articles/two-table.html" target="_blank">website article</a></li>
</ul>
</div>
</div>
</div>
</section>
<section id="mutating-data" class="level2" data-number="6">
<h2 data-number="6"><span class="header-section-number">6</span> Mutating data ğŸ§¬?</h2>
<p>Often, you need to modify your variables, or create new ones.</p>
<section id="modify-and-assign" class="level3" data-number="6.1">
<h3 data-number="6.1"><span class="header-section-number">6.1</span> Modify and assign</h3>
<ol type="1">
<li>Apply a function/transformation to an existing variable (or multiple variables).</li>
<li>Assign the result to a new variable, or overwrite the original variable.</li>
</ol>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Base R ğŸ¤–</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">dplyr::mutate ğŸ‘½</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>For simple transformations you can easily do this with base R.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a logical variable, TRUE if patient has family history of IBD</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>all_meta<span class="sc">$</span>ibd_fhx <span class="ot">&lt;-</span> all_meta<span class="sc">$</span>family_history <span class="sc">==</span> <span class="st">&quot;fhx&quot;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># always check the result is what you expected!</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>all_meta[, <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;family_history&quot;</span>, <span class="st">&quot;ibd_fhx&quot;</span>)]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 Ã— 3
   ID    family_history ibd_fhx
   &lt;chr&gt; &lt;chr&gt;          &lt;lgl&gt;  
 1 099A  nofhx          FALSE  
 2 199A  &lt;NA&gt;           NA     
 3 062B  nofhx          FALSE  
 4 194A  nofhx          FALSE  
 5 166A  &lt;NA&gt;           NA     
 6 219A  nofhx          FALSE  
 7 132A  nofhx          FALSE  
 8 026A  nofhx          FALSE  
 9 102A  fhx            TRUE   
10 140A  nofhx          FALSE  
# â„¹ 80 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>The <code>mutate</code> function from dplyr is great for making multiple or complex transformations. You refer to variables without repeating the name of the dataframe. It is as if you are working â€œinsideâ€ the dataframe.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is equivalent to the previous block</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ibd_fhx =</span> family_history <span class="sc">==</span> <span class="st">&quot;fhx&quot;</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result again</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, family_history, ibd_fhx)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 Ã— 3
   ID    family_history ibd_fhx
   &lt;chr&gt; &lt;chr&gt;          &lt;lgl&gt;  
 1 099A  nofhx          FALSE  
 2 199A  &lt;NA&gt;           NA     
 3 062B  nofhx          FALSE  
 4 194A  nofhx          FALSE  
 5 166A  &lt;NA&gt;           NA     
 6 219A  nofhx          FALSE  
 7 132A  nofhx          FALSE  
 8 026A  nofhx          FALSE  
 9 102A  fhx            TRUE   
10 140A  nofhx          FALSE  
# â„¹ 80 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="temporary-or-persistent" class="level3" data-number="6.2">
<h3 data-number="6.2"><span class="header-section-number">6.2</span> Temporary or persistent?</h3>
<p>We can convert character string variables to factor variables to specify an ordering of their levels (e.g.Â for plotting).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Temporary âš¡</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Persistent ğŸª¨</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>You can temporarily mutate a dataframe and use the result. This is easy with pipes.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diagnosis =</span> <span class="fu">factor</span>(diagnosis, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;CD&quot;</span>, <span class="st">&quot;UC&quot;</span>, <span class="st">&quot;Other&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(diagnosis, age_years)) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-34-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="1200" /></a></p>
</figure>
</div>
</div>
</div>
<p>Notice this did NOT persistently modify the diagnosis variable, it is still â€œcharacterâ€ class.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(all_meta<span class="sc">$</span>diagnosis) <span class="co"># no persistent changes, diagnosis is still character!</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;character&quot;</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p><code>mutate</code> returns a modified dataframe and you must assign this to an object for changes to persist.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">diagnosis =</span> <span class="fu">factor</span>(diagnosis, <span class="fu">c</span>(<span class="st">&quot;CD&quot;</span>, <span class="st">&quot;UC&quot;</span>, <span class="st">&quot;Other&quot;</span>)))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(diagnosis, age_years)) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="practical1A-instructions_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="practical1A-instructions_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="1200" /></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(all_meta<span class="sc">$</span>diagnosis)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;factor&quot;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="more-mutation" class="level3" data-number="6.3">
<h3 data-number="6.3"><span class="header-section-number">6.3</span> More mutation</h3>
<p>We need to clean up the medication history.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(all_meta<span class="sc">$</span>medication, <span class="at">useNA =</span> <span class="st">&quot;if&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                abx           abx, imsp                imsp     mesalamine only 
                  1                   3                  14                   7 
           steroids       steroids, abx steroids, abx, imsp      steroids, imsp 
                 12                   4                  11                  11 
               &lt;NA&gt; 
                 27 </code></pre>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(all_meta<span class="sc">$</span>immunosuppression_level, <span class="at">useNA =</span> <span class="st">&quot;if&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
level0 level1 level2 level3 level4   none   &lt;NA&gt; 
     7     16     18     11     10      4     24 </code></pre>
</div>
</div>
<p>We have NAs for the medication for all the Controls. We know they had â€œnoneâ€, so letâ€™s first indicate that. We will also replace Controlsâ€™ immunosuppression_level NA values with â€œnoneâ€.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">medication =</span> <span class="fu">if_else</span>(case_control <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, <span class="at">true =</span> <span class="st">&quot;none&quot;</span>, <span class="at">false =</span> medication),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">immunosuppression_level =</span> <span class="fu">if_else</span>(case_control <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, <span class="at">true =</span> <span class="st">&quot;none&quot;</span>, <span class="at">false =</span> immunosuppression_level)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result!</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, case_control, medication, immunosuppression_level)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 Ã— 4
   ID    case_control medication          immunosuppression_level
   &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;               &lt;chr&gt;                  
 1 099A  Case         steroids, imsp      level3                 
 2 199A  Control      none                none                   
 3 062B  Case         steroids, imsp      level3                 
 4 194A  Case         steroids            level1                 
 5 166A  Case         abx                 none                   
 6 219A  Case         abx, imsp           level3                 
 7 132A  Case         steroids, imsp      level2                 
 8 026A  Case         steroids, abx, imsp level4                 
 9 102A  Control      none                none                   
10 140A  Control      none                none                   
# â„¹ 80 more rows</code></pre>
</div>
</div>
<p>We now want logical variables indicating if the patient recently had antibiotics (abx), steroids, or other immunosuppressive drugs (imsp).</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">abx =</span> <span class="fu">str_detect</span>(medication, <span class="st">&quot;abx&quot;</span>),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">steroids =</span> <span class="fu">str_detect</span>(medication, <span class="st">&quot;steroids&quot;</span>),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">imsp_other =</span> <span class="fu">str_detect</span>(medication, <span class="st">&quot;imsp&quot;</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">imsp_any =</span> steroids <span class="sc">|</span> imsp_other</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result!</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># all_meta %&gt;% select(case_control, medication, abx, steroids, imsp_other, imsp_any)</span></span></code></pre></div>
</div>
<p>For the character variables with more than two values, we can convert them to factors, to encode our preferred ordering of their levels.</p>
<p>In R stats methods, the 1st level of a factor is often used as the reference level by default. So we should keep this in mind, and typically set control levels as the 1st factor level. We can always temporarily change this for plots.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">diagnosis =</span> <span class="fu">factor</span>(diagnosis, <span class="fu">c</span>(<span class="st">&quot;Other&quot;</span>, <span class="st">&quot;CD&quot;</span>, <span class="st">&quot;UC&quot;</span>)),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">active =</span> <span class="fu">factor</span>(active, <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;inactive&quot;</span>, <span class="st">&quot;active&quot;</span>)),</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">activity =</span> <span class="fu">factor</span>(activity, <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;inactive&quot;</span>, <span class="st">&quot;mild&quot;</span>, <span class="st">&quot;moderate&quot;</span>, <span class="st">&quot;severe&quot;</span>))</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<p>Now you do the same for <code>immunosuppression_level</code>! Donâ€™t forget to check the result</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Click for solution
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">immunosuppression_level =</span> <span class="fu">factor</span>(<span class="at">x =</span> immunosuppression_level, <span class="fu">c</span>(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;none&quot;</span>, <span class="st">&quot;level0&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>, <span class="st">&quot;level4&quot;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">select</span>(diagnosis, activity, immunosuppression_level)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 90 Ã— 3
   diagnosis activity immunosuppression_level
   &lt;fct&gt;     &lt;fct&gt;    &lt;fct&gt;                  
 1 UC        severe   level3                 
 2 Other     control  none                   
 3 CD        mild     level3                 
 4 UC        mild     level1                 
 5 UC        severe   none                   
 6 UC        inactive level3                 
 7 CD        mild     level2                 
 8 UC        mild     level4                 
 9 Other     control  none                   
10 Other     control  none                   
# â„¹ 80 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="save-your-progress" class="level2" data-number="7">
<h2 data-number="7"><span class="header-section-number">7</span> Save your progress ğŸ’¾</h2>
<p>Letâ€™s save the <code>all_meta</code> dataframe in three formats: Excel, CSV, and RDS, all within a folder called â€œprocessedâ€ inside the â€œdataâ€ folder.</p>
<p>First, weâ€™ll create the â€œprocessedâ€ directory.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>output_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;papa2012&quot;</span>, <span class="st">&quot;processed&quot;</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(output_path)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in dir.create(output_path):
&#39;/Users/david/Documents/git/R-projects/teaching/workshops/2024-Liege-microbiome/data/papa2012/processed&#39;
already exists</code></pre>
</div>
</div>
<p>Then we write an excel file, using the <code>write_xlsx</code> function from the <code>writexl</code> package.</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;all_metadata.xlsx&quot;</span>))</span></code></pre></div>
</div>
<p>CSV files are a common format for storing tabular data. We use the <code>write_csv</code> function from the <code>readr</code> package.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;all_metadata.csv&quot;</span>))</span></code></pre></div>
</div>
<p>RDS files are Râ€™s native format for saving single R objects. They preserve data types and structures, making them ideal for saving and loading a variety of R objects.</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;all_metadata.rds&quot;</span>))</span></code></pre></div>
</div>
</section>
<section id="next" class="level2" data-number="8">
<h2 data-number="8"><span class="header-section-number">8</span> Next! â©</h2>
<ul>
<li><p>We have recapped some R fundamentals and introduced the sample metadata.</p></li>
<li><p>Next we will start working with microbiome data!</p></li>
<li><p>Click here: <a href="https://david-barnett.github.io/Liege-microbiome/practical-1/web/practical1B-instructions.html" class="uri">https://david-barnett.github.io/Liege-microbiome/practical-1/web/practical1B-instructions.html</a></p></li>
</ul>
</section>
<section id="session-info" class="level2" data-number="9">
<h2 data-number="9"><span class="header-section-number">9</span> Session info</h2>
<p>For reproducibility, it is useful to record the packages and versions used in your analyses. This is easy to do with <code>sessioninfo::session_info()</code>.</p>
<details>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>â”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 setting  value
 version  R version 4.4.0 (2024-04-24)
 os       macOS Sonoma 14.7
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       Europe/Amsterdam
 date     2024-11-18
 pandoc   3.2 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)

â”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 package      * version date (UTC) lib source
 bit            4.5.0   2024-09-20 [1] RSPM (R 4.4.0)
 bit64          4.5.2   2024-09-22 [1] RSPM (R 4.4.0)
 cellranger     1.1.0   2016-07-27 [1] CRAN (R 4.4.0)
 cli            3.6.3   2024-06-21 [1] CRAN (R 4.4.0)
 codetools      0.2-20  2024-03-31 [1] CRAN (R 4.4.0)
 colorspace     2.1-1   2024-07-26 [1] RSPM (R 4.4.0)
 crayon         1.5.3   2024-06-20 [1] CRAN (R 4.4.0)
 digest         0.6.36  2024-06-23 [1] CRAN (R 4.4.0)
 dplyr        * 1.1.4   2023-11-17 [1] CRAN (R 4.4.0)
 evaluate       0.24.0  2024-06-10 [1] CRAN (R 4.4.0)
 fansi          1.0.6   2023-12-08 [1] CRAN (R 4.4.0)
 farver         2.1.2   2024-05-13 [1] CRAN (R 4.4.0)
 fastmap        1.2.0   2024-05-15 [1] CRAN (R 4.4.0)
 forcats      * 1.0.0   2023-01-29 [1] CRAN (R 4.4.0)
 generics       0.1.3   2022-07-05 [1] CRAN (R 4.4.0)
 ggplot2      * 3.5.1   2024-04-23 [1] CRAN (R 4.4.0)
 glue           1.8.0   2024-09-30 [1] RSPM (R 4.4.0)
 gtable         0.3.5   2024-04-22 [1] CRAN (R 4.4.0)
 here         * 1.0.1   2020-12-13 [1] CRAN (R 4.4.0)
 hms            1.1.3   2023-03-21 [1] CRAN (R 4.4.0)
 htmltools      0.5.8.1 2024-04-04 [1] CRAN (R 4.4.0)
 htmlwidgets    1.6.4   2023-12-06 [1] CRAN (R 4.4.0)
 jsonlite       1.8.8   2023-12-04 [1] CRAN (R 4.4.0)
 knitr          1.48    2024-07-07 [1] RSPM (R 4.4.0)
 labeling       0.4.3   2023-08-29 [1] CRAN (R 4.4.0)
 lifecycle      1.0.4   2023-11-07 [1] CRAN (R 4.4.0)
 lubridate    * 1.9.3   2023-09-27 [1] CRAN (R 4.4.0)
 magrittr       2.0.3   2022-03-30 [1] CRAN (R 4.4.0)
 munsell        0.5.1   2024-04-01 [1] CRAN (R 4.4.0)
 patchwork    * 1.2.0   2024-01-08 [1] RSPM (R 4.4.0)
 pillar         1.9.0   2023-03-22 [1] CRAN (R 4.4.0)
 pkgconfig      2.0.3   2019-09-22 [1] CRAN (R 4.4.0)
 purrr        * 1.0.2   2023-08-10 [1] CRAN (R 4.4.0)
 R6             2.5.1   2021-08-19 [1] CRAN (R 4.4.0)
 ragg           1.3.2   2024-05-15 [1] CRAN (R 4.4.0)
 RColorBrewer   1.1-3   2022-04-03 [1] CRAN (R 4.4.0)
 readr        * 2.1.5   2024-01-10 [1] CRAN (R 4.4.0)
 readxl       * 1.4.3   2023-07-06 [1] CRAN (R 4.4.0)
 rlang          1.1.4   2024-06-04 [1] CRAN (R 4.4.0)
 rmarkdown      2.27    2024-05-17 [1] CRAN (R 4.4.0)
 rprojroot      2.0.4   2023-11-05 [1] CRAN (R 4.4.0)
 rstudioapi     0.16.0  2024-03-24 [1] CRAN (R 4.4.0)
 scales         1.3.0   2023-11-28 [1] CRAN (R 4.4.0)
 sessioninfo    1.2.2   2021-12-06 [1] CRAN (R 4.4.0)
 stringi        1.8.4   2024-05-06 [1] CRAN (R 4.4.0)
 stringr      * 1.5.1   2023-11-14 [1] CRAN (R 4.4.0)
 systemfonts    1.1.0   2024-05-15 [1] CRAN (R 4.4.0)
 textshaping    0.4.0   2024-05-24 [1] CRAN (R 4.4.0)
 tibble       * 3.2.1   2023-03-20 [1] CRAN (R 4.4.0)
 tidyr        * 1.3.1   2024-01-24 [1] CRAN (R 4.4.0)
 tidyselect     1.2.1   2024-03-11 [1] CRAN (R 4.4.0)
 tidyverse    * 2.0.0   2023-02-22 [1] RSPM (R 4.4.0)
 timechange     0.3.0   2024-01-18 [1] CRAN (R 4.4.0)
 tzdb           0.4.0   2023-05-12 [1] CRAN (R 4.4.0)
 utf8           1.2.4   2023-10-22 [1] CRAN (R 4.4.0)
 vctrs          0.6.5   2023-12-01 [1] CRAN (R 4.4.0)
 vroom          1.6.5   2023-12-05 [1] CRAN (R 4.4.0)
 withr          3.0.1   2024-07-31 [1] RSPM (R 4.4.0)
 writexl      * 1.5.0   2024-02-09 [1] CRAN (R 4.4.0)
 xfun           0.46    2024-07-18 [1] RSPM (R 4.4.0)
 yaml           2.3.10  2024-07-26 [1] RSPM (R 4.4.0)

 [1] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</code></pre>
</div>
</div>
</details>
<!-- -->
<div class="quarto-embedded-source-code">
<div class="sourceCode" id="cb72" data-shortcodes="false"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> &quot;Practical 1A - R fundamentals&quot;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> &quot;Liege microbiome workshop&quot;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> David Barnett</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="an">keep-md:</span><span class="co"> false</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="an">theme:</span><span class="co"> </span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co">  light: flatly</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co">  dark: darkly</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="an">css:</span><span class="co"> ../../.css/instructions.css</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="an">embed-resources:</span><span class="co"> true</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-border-left:</span><span class="co"> true</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="an">code-block-bg:</span><span class="co"> true</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="an">fig-align:</span><span class="co"> center</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> right</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 4</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="an">toc-expand:</span><span class="co"> 1</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="an">other-links:</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co">  - text: &quot;Workshop Overview&quot;</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="co">    href: &quot;https://david-barnett.github.io/Liege-microbiome&quot;</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="co">    icon: &quot;house&quot;</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="co">    target: &quot;_blank&quot;</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="co">  - text: &quot;posit.cloud workspace&quot;</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co">    href: &quot;https://posit.cloud/spaces/583413&quot;</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="co">    icon: &quot;cloud&quot;</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a><span class="co">    target: &quot;_blank&quot;</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a><span class="an">number-depth:</span><span class="co"> 3</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a><span class="an">fig-dpi:</span><span class="co"> 200</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="an">fig-width:</span><span class="co"> 7.5</span></span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="an">fig-height:</span><span class="co"> 5</span></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a><span class="an">fig-responsive:</span><span class="co"> true</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> false</span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a><span class="an">code-link:</span><span class="co"> true</span></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a><span class="an">link-external-icon:</span><span class="co"> true</span></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a><span class="an">cache:</span><span class="co"> true</span></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction ğŸ‘‹</span></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning goals ğŸ§ </span></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Using Quarto</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Reading tabular data</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Inspecting data</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Joining data frames</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mutating data frames</span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Getting started ğŸš€</span></span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>In this workshop we will use an online version of <span class="co">[</span><span class="ot">RStudio</span><span class="co">](https://posit.co/download/rstudio-desktop/ &quot;RStudio is an application where you write and run R code&quot;)</span>{target=&quot;_blank&quot;} - via <span class="co">[</span><span class="ot">posit.cloud</span><span class="co">](https://posit.cloud/spaces/583413! &quot;Posit Cloud provides a cloud server to run and share RStudio projects&quot;)</span>{target=&quot;_blank&quot;}</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span><span class="co">[</span><span class="ot">Sign up for a free posit.cloud account</span><span class="co">](https://posit.cloud/spaces/583413!)</span>{target=&quot;_blank&quot;}\</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>    (use a GitHub or Google account if you already have one of these)</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Check your email for a link to join the posit.cloud space for this course</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Click on the **Liege-microbiome** project - this will start RStudio</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Go to **Files** (look bottom right) <span class="sc">\&gt;</span> click folder <span class="in">`practical-1`</span> <span class="sc">\&gt;</span> open file <span class="in">`practical-1A-notebook.qmd`</span></span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using Quarto ğŸ“</span></span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>We will write code and notes in <span class="co">[</span><span class="ot">Quarto</span><span class="co">](https://r4ds.hadley.nz/quarto)</span>{target=&quot;_blank&quot;} <span class="in">`.qmd`</span> documents, e.g. <span class="in">`practical-1A-notebook.qmd`</span></span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Write some notes:**</span></span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>You can write normal text for notes, e.g. your intentions, hypotheses, observations, etc.</span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a>To edit your Quarto notebooks in RStudio you can use &quot;<span class="co">[</span><span class="ot">Visual</span><span class="co">](https://quarto.org/docs/visual-editor/)</span>{target=&quot;_blank&quot;}&quot; editor mode, or the &quot;Source&quot; mode.</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a>*Toggle between modes at the top left. Visual editor is easier for beginners, but Source mode shows how the Quarto file truly looks (it only contains [markdown](https://quarto.org/docs/authoring/markdown-basics.html &quot;Markdown is plain text, with special characters to indicate headings, bold text, links etc&quot;){target=&quot;_blank&quot;} text, but RStudio adds formatting in Visual mode).*</span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **Write and run code:**</span></span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a>You can write code and comments in &quot;chunks&quot; - like the one below.</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>Run a chunk by clicking the green play button in the corner of the chunk</span>
<span id="cb72-83"><a href="#cb72-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-84"><a href="#cb72-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb72-85"><a href="#cb72-85" aria-hidden="true" tabindex="-1"></a><span class="in"># This is a comment, because it starts with the # symbol</span></span>
<span id="cb72-86"><a href="#cb72-86" aria-hidden="true" tabindex="-1"></a><span class="in">print(&quot;This line is code, try to run it!&quot;) </span></span>
<span id="cb72-87"><a href="#cb72-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-88"><a href="#cb72-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-89"><a href="#cb72-89" aria-hidden="true" tabindex="-1"></a>Insert a code chunk with <span class="in">`Ctrl`</span>+<span class="in">`Alt`</span>+<span class="in">`I`</span> (Windows) or <span class="in">`Cmd`</span>+<span class="in">`Option`</span>+<span class="in">`I`</span> (Mac).</span>
<span id="cb72-90"><a href="#cb72-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-91"><a href="#cb72-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb72-92"><a href="#cb72-92" aria-hidden="true" tabindex="-1"></a><span class="in"># You can also run code with keyboard shortcuts!</span></span>
<span id="cb72-93"><a href="#cb72-93" aria-hidden="true" tabindex="-1"></a><span class="in">print(&quot;Run this one line with Ctrl + Enter, or Cmd + Enter on Mac&quot;)</span></span>
<span id="cb72-94"><a href="#cb72-94" aria-hidden="true" tabindex="-1"></a><span class="in">print(&quot;or run a whole chunk with Ctrl/Cmd + SHIFT + Enter&quot;)</span></span>
<span id="cb72-95"><a href="#cb72-95" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-96"><a href="#cb72-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-97"><a href="#cb72-97" aria-hidden="true" tabindex="-1"></a>You can run all previous chunks by clicking the other button in the corner of the chunk.</span>
<span id="cb72-98"><a href="#cb72-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-99"><a href="#cb72-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load R packages ğŸ“¦</span></span>
<span id="cb72-100"><a href="#cb72-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-101"><a href="#cb72-101" aria-hidden="true" tabindex="-1"></a>It is a good idea to load all the packages you need at the top of your notebook.</span>
<span id="cb72-102"><a href="#cb72-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-103"><a href="#cb72-103" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-104"><a href="#cb72-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-105"><a href="#cb72-105" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-106"><a href="#cb72-106" aria-hidden="true" tabindex="-1"></a><span class="co"># `readxl` is for reading data from Excel files</span></span>
<span id="cb72-107"><a href="#cb72-107" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb72-108"><a href="#cb72-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-109"><a href="#cb72-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-110"><a href="#cb72-110" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-111"><a href="#cb72-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-112"><a href="#cb72-112" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-113"><a href="#cb72-113" aria-hidden="true" tabindex="-1"></a><span class="co"># `writexl` is for writing data to a new Excel file</span></span>
<span id="cb72-114"><a href="#cb72-114" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl) <span class="co"># we&#39;ll use this at the end</span></span>
<span id="cb72-115"><a href="#cb72-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-116"><a href="#cb72-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-117"><a href="#cb72-117" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-118"><a href="#cb72-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-119"><a href="#cb72-119" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-120"><a href="#cb72-120" aria-hidden="true" tabindex="-1"></a><span class="co"># the `here` package makes specifying file locations easier</span></span>
<span id="cb72-121"><a href="#cb72-121" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb72-122"><a href="#cb72-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-123"><a href="#cb72-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-124"><a href="#cb72-124" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-125"><a href="#cb72-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-126"><a href="#cb72-126" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-127"><a href="#cb72-127" aria-hidden="true" tabindex="-1"></a><span class="co"># `tidyverse` is a collection of several packages </span></span>
<span id="cb72-128"><a href="#cb72-128" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># (dplyr, ggplot2, and others)</span></span>
<span id="cb72-129"><a href="#cb72-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-130"><a href="#cb72-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-131"><a href="#cb72-131" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reading data ğŸ“‚ {#reading-data}</span></span>
<span id="cb72-132"><a href="#cb72-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-133"><a href="#cb72-133" aria-hidden="true" tabindex="-1"></a>How do we read a table of data from a file, e.g. an Excel file?</span>
<span id="cb72-134"><a href="#cb72-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-135"><a href="#cb72-135" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-136"><a href="#cb72-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-137"><a href="#cb72-137" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-138"><a href="#cb72-138" aria-hidden="true" tabindex="-1"></a><span class="co"># give your objects short but informative names!</span></span>
<span id="cb72-139"><a href="#cb72-139" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="fu">here</span>(<span class="st">&quot;data/papa2012/papa2012_metadata.xlsx&quot;</span>), <span class="at">na =</span> <span class="st">&quot;NA&quot;</span>)</span>
<span id="cb72-140"><a href="#cb72-140" aria-hidden="true" tabindex="-1"></a>meds <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">here</span>(<span class="st">&quot;data/papa2012/papa2012_metadata.xlsx&quot;</span>), <span class="at">sheet =</span> <span class="st">&quot;treatment&quot;</span>)</span>
<span id="cb72-141"><a href="#cb72-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-142"><a href="#cb72-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-143"><a href="#cb72-143" aria-hidden="true" tabindex="-1"></a>::: {#tip-paths .callout-tip collapse=&quot;false&quot;}</span>
<span id="cb72-144"><a href="#cb72-144" aria-hidden="true" tabindex="-1"></a><span class="fu">## Projects and portable file paths</span></span>
<span id="cb72-145"><a href="#cb72-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-146"><a href="#cb72-146" aria-hidden="true" tabindex="-1"></a>There are multiple ways to tell R where to find the data files for a project.</span>
<span id="cb72-147"><a href="#cb72-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-148"><a href="#cb72-148" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-149"><a href="#cb72-149" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Projects + relative paths</span></span>
<span id="cb72-150"><a href="#cb72-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-151"><a href="#cb72-151" aria-hidden="true" tabindex="-1"></a>ğŸ‘ **The best way** ğŸ‘</span>
<span id="cb72-152"><a href="#cb72-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-153"><a href="#cb72-153" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>For each data analysis project you do, create a separate folder for that project, and keep all relevant code and data inside that folder.</span>
<span id="cb72-154"><a href="#cb72-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-155"><a href="#cb72-155" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>RStudio also offers additional convenient features for organisation with <span class="co">[</span><span class="ot">RStudio Projects</span><span class="co">](https://r4ds.hadley.nz/workflow-scripts.html#rstudio-projects &quot;Section of R for Data Science book introducing RStudio projects&quot;)</span>{target=&quot;_blank&quot;}!</span>
<span id="cb72-156"><a href="#cb72-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-157"><a href="#cb72-157" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Using the R package called <span class="in">`here`</span> you can easily specify the location of your data using file paths relative to the project folder. The <span class="in">`here`</span> package offers one important function, also called <span class="in">`here()`</span></span>
<span id="cb72-158"><a href="#cb72-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-159"><a href="#cb72-159" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-160"><a href="#cb72-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-161"><a href="#cb72-161" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-162"><a href="#cb72-162" aria-hidden="true" tabindex="-1"></a><span class="co"># this will work anywhere! (anywhere that the project folder is moved or copied)</span></span>
<span id="cb72-163"><a href="#cb72-163" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="fu">here</span>(<span class="st">&quot;data/papa2012/papa2012_metadata.xlsx&quot;</span>), <span class="at">na =</span> <span class="st">&quot;NA&quot;</span>)</span>
<span id="cb72-164"><a href="#cb72-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-165"><a href="#cb72-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-166"><a href="#cb72-166" aria-hidden="true" tabindex="-1"></a>This is reliable and portable! ğŸ¤© If you share the entire project folder with a collaborator (e.g. as a zip file or via github) then this code will work on their computer without needing any changes!</span>
<span id="cb72-167"><a href="#cb72-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-168"><a href="#cb72-168" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Absolute paths</span></span>
<span id="cb72-169"><a href="#cb72-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-170"><a href="#cb72-170" aria-hidden="true" tabindex="-1"></a>ğŸ˜ **Easy but limiting** ğŸ˜</span>
<span id="cb72-171"><a href="#cb72-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-172"><a href="#cb72-172" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>An absolute path (also known as a full path) can be used to specify where a file is on your own computer.</span>
<span id="cb72-173"><a href="#cb72-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-174"><a href="#cb72-174" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>This will work okay, but only if you never move your files, and never change computer...</span>
<span id="cb72-175"><a href="#cb72-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-176"><a href="#cb72-176" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Using absolute paths makes it **inconvenient** to share your project or work collaboratively. ğŸ™</span>
<span id="cb72-177"><a href="#cb72-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-178"><a href="#cb72-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb72-179"><a href="#cb72-179" aria-hidden="true" tabindex="-1"></a><span class="in"># this works on my machine, but it won&#39;t work anywhere else!</span></span>
<span id="cb72-180"><a href="#cb72-180" aria-hidden="true" tabindex="-1"></a><span class="in">meta &lt;- read_excel(</span></span>
<span id="cb72-181"><a href="#cb72-181" aria-hidden="true" tabindex="-1"></a><span class="in">  path = &quot;/Users/david/Documents/teaching/workshops/Liege-microbiome/data/papa2012/papa2012_metadata.xlsx&quot;, </span></span>
<span id="cb72-182"><a href="#cb72-182" aria-hidden="true" tabindex="-1"></a><span class="in">  na = &quot;NA&quot;</span></span>
<span id="cb72-183"><a href="#cb72-183" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb72-184"><a href="#cb72-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-185"><a href="#cb72-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-186"><a href="#cb72-186" aria-hidden="true" tabindex="-1"></a><span class="fu">#### setwd + relative paths</span></span>
<span id="cb72-187"><a href="#cb72-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-188"><a href="#cb72-188" aria-hidden="true" tabindex="-1"></a>ğŸ¤· **Commonly used but still problematic** ğŸ¤·</span>
<span id="cb72-189"><a href="#cb72-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-190"><a href="#cb72-190" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>You can use paths relative to the *working directory* set with <span class="in">`setwd(&quot;/an/absolute/path/on/your/computer&quot;)`</span>, BUT:</span>
<span id="cb72-191"><a href="#cb72-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-192"><a href="#cb72-192" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>setwd still uses an absolute path, so it is still not portable!</span>
<span id="cb72-193"><a href="#cb72-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-194"><a href="#cb72-194" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>setwd does not work in notebooks, which reset working directory every chunk</span>
<span id="cb72-195"><a href="#cb72-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-196"><a href="#cb72-196" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Prof. Jenny Bryan might set your computer on fire! ğŸ–¥ï¸ğŸ”¥ (<span class="co">[</span><span class="ot">read why here</span><span class="co">](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/)</span>{target=&quot;_blank&quot;})</span>
<span id="cb72-197"><a href="#cb72-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-198"><a href="#cb72-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb72-199"><a href="#cb72-199" aria-hidden="true" tabindex="-1"></a><span class="in"># this works on my machine, but it won&#39;t work anywhere else!</span></span>
<span id="cb72-200"><a href="#cb72-200" aria-hidden="true" tabindex="-1"></a><span class="in">setwd(&quot;/Users/david/Documents/teaching/workshops/Liege-microbiome&quot;)</span></span>
<span id="cb72-201"><a href="#cb72-201" aria-hidden="true" tabindex="-1"></a><span class="in">meta &lt;- read_excel(path = &quot;data/papa2012/papa2012_metadata.xlsx&quot;, na = &quot;NA&quot;)</span></span>
<span id="cb72-202"><a href="#cb72-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-203"><a href="#cb72-203" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-204"><a href="#cb72-204" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-205"><a href="#cb72-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-206"><a href="#cb72-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Inspecting data {#inspecting-data}</span></span>
<span id="cb72-207"><a href="#cb72-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-208"><a href="#cb72-208" aria-hidden="true" tabindex="-1"></a><span class="fu">### Look at the tables ğŸ‘€</span></span>
<span id="cb72-209"><a href="#cb72-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-210"><a href="#cb72-210" aria-hidden="true" tabindex="-1"></a>Start by printing the metadata data frame, like this:</span>
<span id="cb72-211"><a href="#cb72-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-212"><a href="#cb72-212" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-213"><a href="#cb72-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-214"><a href="#cb72-214" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-215"><a href="#cb72-215" aria-hidden="true" tabindex="-1"></a>meta</span>
<span id="cb72-216"><a href="#cb72-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-217"><a href="#cb72-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-218"><a href="#cb72-218" aria-hidden="true" tabindex="-1"></a>::: {#tip-looking .callout-tip collapse=&quot;true&quot;}</span>
<span id="cb72-219"><a href="#cb72-219" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is (in) this object?</span></span>
<span id="cb72-220"><a href="#cb72-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-221"><a href="#cb72-221" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-222"><a href="#cb72-222" aria-hidden="true" tabindex="-1"></a><span class="fu">##### dataframes &amp; tibbles</span></span>
<span id="cb72-223"><a href="#cb72-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-224"><a href="#cb72-224" aria-hidden="true" tabindex="-1"></a>A dataframe is the standard class of object for holding rectangular data (tables) in your R environment.</span>
<span id="cb72-225"><a href="#cb72-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-226"><a href="#cb72-226" aria-hidden="true" tabindex="-1"></a>Columns of a dataframe can hold vectors of different classes, e.g. chr and int (characters and integers)</span>
<span id="cb72-227"><a href="#cb72-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-228"><a href="#cb72-228" aria-hidden="true" tabindex="-1"></a>(In contrast, a matrix can only hold one type of data!)</span>
<span id="cb72-229"><a href="#cb72-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-230"><a href="#cb72-230" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-231"><a href="#cb72-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-232"><a href="#cb72-232" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-233"><a href="#cb72-233" aria-hidden="true" tabindex="-1"></a>example_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">alphabet =</span> LETTERS, <span class="at">numbers =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>)</span>
<span id="cb72-234"><a href="#cb72-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-235"><a href="#cb72-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-236"><a href="#cb72-236" aria-hidden="true" tabindex="-1"></a>Try <span class="in">`View(example_df)`</span> in the Console - but not in a Quarto doc chunk</span>
<span id="cb72-237"><a href="#cb72-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-238"><a href="#cb72-238" aria-hidden="true" tabindex="-1"></a>A tibble is just a dataframe, but with a concise print format, useful!</span>
<span id="cb72-239"><a href="#cb72-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-240"><a href="#cb72-240" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-241"><a href="#cb72-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-242"><a href="#cb72-242" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-243"><a href="#cb72-243" aria-hidden="true" tabindex="-1"></a>example_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(example_df)</span>
<span id="cb72-244"><a href="#cb72-244" aria-hidden="true" tabindex="-1"></a>example_tbl</span>
<span id="cb72-245"><a href="#cb72-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-246"><a href="#cb72-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-247"><a href="#cb72-247" aria-hidden="true" tabindex="-1"></a><span class="fu">##### vector classes?</span></span>
<span id="cb72-248"><a href="#cb72-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-249"><a href="#cb72-249" aria-hidden="true" tabindex="-1"></a>Each column in a dataframe/tibble can be on of the following types of vector object</span>
<span id="cb72-250"><a href="#cb72-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-251"><a href="#cb72-251" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**numeric**: real numbers, e.g., <span class="in">`c(7.5, -2.301, 0.666)`</span>.</span>
<span id="cb72-252"><a href="#cb72-252" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**integer**: whole numbers, e.g., <span class="in">`c(9L, 4L, -123L)`</span>.</span>
<span id="cb72-253"><a href="#cb72-253" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**logical**: Boolean values, e.g., <span class="in">`c(TRUE, FALSE)`</span>.</span>
<span id="cb72-254"><a href="#cb72-254" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**character**: strings of text, e.g., <span class="in">`c(&quot;no&quot;, &quot;yes&quot;, &quot;unsure&quot;)`</span>.</span>
<span id="cb72-255"><a href="#cb72-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**factor**: categories with fixed levels, e.g., <span class="in">`factor(c(&quot;no&quot;, &quot;yes&quot;, &quot;unsure&quot;))`</span>.</span>
<span id="cb72-256"><a href="#cb72-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-257"><a href="#cb72-257" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-258"><a href="#cb72-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-259"><a href="#cb72-259" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-260"><a href="#cb72-260" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta<span class="sc">$</span>family_history, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span>
<span id="cb72-261"><a href="#cb72-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-262"><a href="#cb72-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-263"><a href="#cb72-263" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-264"><a href="#cb72-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-265"><a href="#cb72-265" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-266"><a href="#cb72-266" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(meta<span class="sc">$</span>age_years, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span>
<span id="cb72-267"><a href="#cb72-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-268"><a href="#cb72-268" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-269"><a href="#cb72-269" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-270"><a href="#cb72-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-271"><a href="#cb72-271" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarise ğŸ“‹</span></span>
<span id="cb72-272"><a href="#cb72-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-273"><a href="#cb72-273" aria-hidden="true" tabindex="-1"></a>You can count the number of times a category occurs, similar to the table function.</span>
<span id="cb72-274"><a href="#cb72-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-275"><a href="#cb72-275" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-276"><a href="#cb72-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-277"><a href="#cb72-277" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-278"><a href="#cb72-278" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">count</span>(diagnosis)</span>
<span id="cb72-279"><a href="#cb72-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-280"><a href="#cb72-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-281"><a href="#cb72-281" aria-hidden="true" tabindex="-1"></a>Or count combinations of categories.</span>
<span id="cb72-282"><a href="#cb72-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-283"><a href="#cb72-283" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-284"><a href="#cb72-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-285"><a href="#cb72-285" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-286"><a href="#cb72-286" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">count</span>(family_history, diagnosis)</span>
<span id="cb72-287"><a href="#cb72-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-288"><a href="#cb72-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-289"><a href="#cb72-289" aria-hidden="true" tabindex="-1"></a>Or compute other summary statistics.</span>
<span id="cb72-290"><a href="#cb72-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-291"><a href="#cb72-291" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-292"><a href="#cb72-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-293"><a href="#cb72-293" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-294"><a href="#cb72-294" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">age_mean =</span> <span class="fu">mean</span>(age_years), <span class="at">age_sd =</span> <span class="fu">sd</span>(age_years))</span>
<span id="cb72-295"><a href="#cb72-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-296"><a href="#cb72-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-297"><a href="#cb72-297" aria-hidden="true" tabindex="-1"></a>Or compute grouped summary statistics</span>
<span id="cb72-298"><a href="#cb72-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-299"><a href="#cb72-299" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-300"><a href="#cb72-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-301"><a href="#cb72-301" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-302"><a href="#cb72-302" aria-hidden="true" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">age_mean =</span> <span class="fu">mean</span>(age_years), <span class="at">age_sd =</span> <span class="fu">sd</span>(age_years), <span class="at">.by =</span> diagnosis)</span>
<span id="cb72-303"><a href="#cb72-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-304"><a href="#cb72-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-305"><a href="#cb72-305" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualise ğŸ“Š</span></span>
<span id="cb72-306"><a href="#cb72-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-307"><a href="#cb72-307" aria-hidden="true" tabindex="-1"></a>R&#39;s base graphics can be used to quickly summarise data distributions.</span>
<span id="cb72-308"><a href="#cb72-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-309"><a href="#cb72-309" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-310"><a href="#cb72-310" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Histogram</span></span>
<span id="cb72-311"><a href="#cb72-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-312"><a href="#cb72-312" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-313"><a href="#cb72-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-314"><a href="#cb72-314" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-315"><a href="#cb72-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb72-316"><a href="#cb72-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb72-317"><a href="#cb72-317" aria-hidden="true" tabindex="-1"></a>meta<span class="sc">$</span>age_years <span class="sc">%&gt;%</span> <span class="fu">hist</span>(<span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">xlab =</span> <span class="st">&quot;Age&quot;</span>)</span>
<span id="cb72-318"><a href="#cb72-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-319"><a href="#cb72-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-320"><a href="#cb72-320" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bar chart</span></span>
<span id="cb72-321"><a href="#cb72-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-322"><a href="#cb72-322" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-323"><a href="#cb72-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-324"><a href="#cb72-324" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-325"><a href="#cb72-325" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb72-326"><a href="#cb72-326" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb72-327"><a href="#cb72-327" aria-hidden="true" tabindex="-1"></a>meta<span class="sc">$</span>activity <span class="sc">%&gt;%</span> <span class="fu">table</span>() <span class="sc">%&gt;%</span> <span class="fu">barplot</span>(<span class="at">xlab =</span> <span class="st">&quot;Disease Activity&quot;</span>)</span>
<span id="cb72-328"><a href="#cb72-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-329"><a href="#cb72-329" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-330"><a href="#cb72-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-331"><a href="#cb72-331" aria-hidden="true" tabindex="-1"></a>ggplot2 is a popular and powerful plotting package.</span>
<span id="cb72-332"><a href="#cb72-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-333"><a href="#cb72-333" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-334"><a href="#cb72-334" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Histogram</span></span>
<span id="cb72-335"><a href="#cb72-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-336"><a href="#cb72-336" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-337"><a href="#cb72-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-338"><a href="#cb72-338" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-339"><a href="#cb72-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb72-340"><a href="#cb72-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb72-341"><a href="#cb72-341" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(meta) <span class="sc">+</span></span>
<span id="cb72-342"><a href="#cb72-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(age_years), <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-343"><a href="#cb72-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>case_control, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-344"><a href="#cb72-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb72-345"><a href="#cb72-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-346"><a href="#cb72-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-347"><a href="#cb72-347" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bar chart</span></span>
<span id="cb72-348"><a href="#cb72-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-349"><a href="#cb72-349" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-350"><a href="#cb72-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-351"><a href="#cb72-351" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-352"><a href="#cb72-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb72-353"><a href="#cb72-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb72-354"><a href="#cb72-354" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(meta) <span class="sc">+</span></span>
<span id="cb72-355"><a href="#cb72-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> activity, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span></span>
<span id="cb72-356"><a href="#cb72-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb72-357"><a href="#cb72-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-358"><a href="#cb72-358" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-359"><a href="#cb72-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-360"><a href="#cb72-360" aria-hidden="true" tabindex="-1"></a>::: {#tip-ggsave .callout-tip collapse=&quot;true&quot;}</span>
<span id="cb72-361"><a href="#cb72-361" aria-hidden="true" tabindex="-1"></a><span class="fu">### `ggsave` to save your plots? ğŸ¦¸ğŸ“ŠğŸ’¾</span></span>
<span id="cb72-362"><a href="#cb72-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-363"><a href="#cb72-363" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Viewing your plots in RStudio is okay for practice</span>
<span id="cb72-364"><a href="#cb72-364" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>But don&#39;t copy paste them to save them, as there is a much better way!</span>
<span id="cb72-365"><a href="#cb72-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-366"><a href="#cb72-366" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-367"><a href="#cb72-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-368"><a href="#cb72-368" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-369"><a href="#cb72-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign your plot to an R object</span></span>
<span id="cb72-370"><a href="#cb72-370" aria-hidden="true" tabindex="-1"></a>plot_practice_bars <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(meta) <span class="sc">+</span></span>
<span id="cb72-371"><a href="#cb72-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> activity, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span></span>
<span id="cb72-372"><a href="#cb72-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practice bar chart&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-373"><a href="#cb72-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb72-374"><a href="#cb72-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-375"><a href="#cb72-375" aria-hidden="true" tabindex="-1"></a><span class="co"># create a folder for figures</span></span>
<span id="cb72-376"><a href="#cb72-376" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(<span class="st">&quot;practical-1/figs&quot;</span>))</span>
<span id="cb72-377"><a href="#cb72-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-378"><a href="#cb72-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the plot to a file, with ggsave</span></span>
<span id="cb72-379"><a href="#cb72-379" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb72-380"><a href="#cb72-380" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> plot_practice_bars, </span>
<span id="cb72-381"><a href="#cb72-381" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="fu">here</span>(<span class="st">&quot;practical-1/figs/practice-barchart.png&quot;</span>),</span>
<span id="cb72-382"><a href="#cb72-382" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;in&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb72-383"><a href="#cb72-383" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-384"><a href="#cb72-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-385"><a href="#cb72-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-386"><a href="#cb72-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb72-387"><a href="#cb72-387" aria-hidden="true" tabindex="-1"></a><span class="in">unlink(here(&quot;practical-1/figs&quot;), recursive = TRUE)</span></span>
<span id="cb72-388"><a href="#cb72-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-389"><a href="#cb72-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-390"><a href="#cb72-390" aria-hidden="true" tabindex="-1"></a>**Be sure to carefully adjust the sizing and resolution of your plots for your paper or presentation!**</span>
<span id="cb72-391"><a href="#cb72-391" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-392"><a href="#cb72-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-393"><a href="#cb72-393" aria-hidden="true" tabindex="-1"></a>::: {#tip-fig-quarto .callout-tip collapse=&quot;true&quot;}</span>
<span id="cb72-394"><a href="#cb72-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sizing plots in Quarto reports ğŸ“ğŸ“ŠğŸ“„</span></span>
<span id="cb72-395"><a href="#cb72-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-396"><a href="#cb72-396" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Again, viewing your plots in the RStudio is only okay for practice.</span>
<span id="cb72-397"><a href="#cb72-397" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If you&#39;re using Quarto reports, you can specify figure size and resolution in each chunk</span>
<span id="cb72-398"><a href="#cb72-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-399"><a href="#cb72-399" aria-hidden="true" tabindex="-1"></a>e.g.</span>
<span id="cb72-400"><a href="#cb72-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-401"><a href="#cb72-401" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-402"><a href="#cb72-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-403"><a href="#cb72-403" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-404"><a href="#cb72-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb72-405"><a href="#cb72-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb72-406"><a href="#cb72-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: fenced</span></span>
<span id="cb72-407"><a href="#cb72-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-408"><a href="#cb72-408" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(meta) <span class="sc">+</span></span>
<span id="cb72-409"><a href="#cb72-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> activity, <span class="at">fill =</span> diagnosis)) <span class="sc">+</span></span>
<span id="cb72-410"><a href="#cb72-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practice bar chart&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-411"><a href="#cb72-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb72-412"><a href="#cb72-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-413"><a href="#cb72-413" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-414"><a href="#cb72-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-415"><a href="#cb72-415" aria-hidden="true" tabindex="-1"></a>::: {#tip-ggplot .callout-tip collapse=&quot;true&quot;}</span>
<span id="cb72-416"><a href="#cb72-416" aria-hidden="true" tabindex="-1"></a><span class="fu">## Become a ggplot2 wizard ğŸ§™</span></span>
<span id="cb72-417"><a href="#cb72-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-418"><a href="#cb72-418" aria-hidden="true" tabindex="-1"></a>We will use ggplot2 throughout much of this workshop.</span>
<span id="cb72-419"><a href="#cb72-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-420"><a href="#cb72-420" aria-hidden="true" tabindex="-1"></a>It is a powerful and flexible tool, but it takes practice to learn the details.</span>
<span id="cb72-421"><a href="#cb72-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-422"><a href="#cb72-422" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-423"><a href="#cb72-423" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Resources</span></span>
<span id="cb72-424"><a href="#cb72-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-425"><a href="#cb72-425" aria-hidden="true" tabindex="-1"></a>Links to good resources for learning ggplot2</span>
<span id="cb72-426"><a href="#cb72-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-427"><a href="#cb72-427" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R 4 Data Science book</span><span class="co">](https://r4ds.hadley.nz/visualize.html)</span>{target=&quot;_blank&quot;} - intro to plots in R</span>
<span id="cb72-428"><a href="#cb72-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-429"><a href="#cb72-429" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R Graphics Cookbook</span><span class="co">](https://r-graphics.org/)</span>{target=&quot;_blank&quot;} - quick practical guide</span>
<span id="cb72-430"><a href="#cb72-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-431"><a href="#cb72-431" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R graph gallery</span><span class="co">](https://r-graph-gallery.com/)</span>{target=&quot;_blank&quot;} - ideas and example code</span>
<span id="cb72-432"><a href="#cb72-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-433"><a href="#cb72-433" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ggplot2 website</span><span class="co">](https://ggplot2.tidyverse.org/reference/index.html)</span>{target=&quot;_blank&quot;} - a reference manual</span>
<span id="cb72-434"><a href="#cb72-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-435"><a href="#cb72-435" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ggplot2 book</span><span class="co">](https://ggplot2-book.org/)</span>{target=&quot;_blank&quot;} - for a thorough grounding</span>
<span id="cb72-436"><a href="#cb72-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-437"><a href="#cb72-437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Cedric Scherer&#39;s blog</span><span class="co">](https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/)</span>{target=&quot;_blank&quot;} - tutorial/examples</span>
<span id="cb72-438"><a href="#cb72-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-439"><a href="#cb72-439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Metaprogramming, Advanced R</span><span class="co">](https://adv-r.hadley.nz/metaprogramming.html)</span>{target=&quot;_blank&quot;} - experts only ğŸ¤¯</span>
<span id="cb72-440"><a href="#cb72-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-441"><a href="#cb72-441" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example</span></span>
<span id="cb72-442"><a href="#cb72-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-443"><a href="#cb72-443" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-444"><a href="#cb72-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-445"><a href="#cb72-445" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-446"><a href="#cb72-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb72-447"><a href="#cb72-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb72-448"><a href="#cb72-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb72-449"><a href="#cb72-449" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb72-450"><a href="#cb72-450" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb72-451"><a href="#cb72-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-452"><a href="#cb72-452" aria-hidden="true" tabindex="-1"></a>plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-453"><a href="#cb72-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-454"><a href="#cb72-454" aria-hidden="true" tabindex="-1"></a><span class="co"># age boxplot</span></span>
<span id="cb72-455"><a href="#cb72-455" aria-hidden="true" tabindex="-1"></a>plot_list<span class="sc">$</span>box <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span></span>
<span id="cb72-456"><a href="#cb72-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> case_control, <span class="at">x =</span> age_years)) <span class="sc">+</span></span>
<span id="cb72-457"><a href="#cb72-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb72-458"><a href="#cb72-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> case_control),</span>
<span id="cb72-459"><a href="#cb72-459" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">staplewidth =</span> <span class="fl">0.5</span>, <span class="at">outliers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb72-460"><a href="#cb72-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">y =</span> <span class="fl">0.2</span>),</span>
<span id="cb72-461"><a href="#cb72-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb72-462"><a href="#cb72-462" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-463"><a href="#cb72-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.05</span>, <span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-464"><a href="#cb72-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Age Distributions&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-465"><a href="#cb72-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-466"><a href="#cb72-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">20</span>, <span class="at">r =</span> <span class="dv">20</span>))</span>
<span id="cb72-467"><a href="#cb72-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-468"><a href="#cb72-468" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_list$box</span></span>
<span id="cb72-469"><a href="#cb72-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-470"><a href="#cb72-470" aria-hidden="true" tabindex="-1"></a><span class="co"># family history piechart</span></span>
<span id="cb72-471"><a href="#cb72-471" aria-hidden="true" tabindex="-1"></a>plot_list<span class="sc">$</span>pie <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span></span>
<span id="cb72-472"><a href="#cb72-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> family_history)) <span class="sc">+</span></span>
<span id="cb72-473"><a href="#cb72-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-474"><a href="#cb72-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb72-475"><a href="#cb72-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="at">fhx =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">nofhx =</span> <span class="st">&quot;grey70&quot;</span>),</span>
<span id="cb72-476"><a href="#cb72-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">&quot;white&quot;</span>, <span class="at">guide =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb72-477"><a href="#cb72-477" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-478"><a href="#cb72-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">I</span>(pi <span class="sc">/</span> <span class="dv">8</span>), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.25</span>), <span class="at">label =</span> <span class="st">&quot;NA&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-479"><a href="#cb72-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">I</span>(<span class="fl">0.9</span> <span class="sc">*</span> pi), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.25</span>), <span class="at">label =</span> <span class="st">&quot;No FHx&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-480"><a href="#cb72-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">I</span>(<span class="fl">1.7</span> <span class="sc">*</span> pi), <span class="at">y =</span> <span class="fu">I</span>(<span class="fl">0.25</span>), <span class="at">label =</span> <span class="st">&quot;FHx&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-481"><a href="#cb72-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">tag =</span> <span class="st">&quot;Family History&quot;</span>) <span class="sc">+</span></span>
<span id="cb72-482"><a href="#cb72-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb72-483"><a href="#cb72-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_radial</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>, <span class="at">inner.radius =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb72-484"><a href="#cb72-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb72-485"><a href="#cb72-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag.location =</span> <span class="st">&quot;panel&quot;</span>, <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>))</span>
<span id="cb72-486"><a href="#cb72-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-487"><a href="#cb72-487" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_list$pie</span></span>
<span id="cb72-488"><a href="#cb72-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-489"><a href="#cb72-489" aria-hidden="true" tabindex="-1"></a><span class="co"># activity barchart</span></span>
<span id="cb72-490"><a href="#cb72-490" aria-hidden="true" tabindex="-1"></a>plot_list<span class="sc">$</span>bar <span class="ot">&lt;-</span> meta <span class="sc">%&gt;%</span></span>
<span id="cb72-491"><a href="#cb72-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb72-492"><a href="#cb72-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> diagnosis,</span>
<span id="cb72-493"><a href="#cb72-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">factor</span>(activity, <span class="fu">c</span>(<span class="st">&quot;severe&quot;</span>, <span class="st">&quot;moderate&quot;</span>, <span class="st">&quot;mild&quot;</span>, <span class="st">&quot;inactive&quot;</span>))</span>
<span id="cb72-494"><a href="#cb72-494" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb72-495"><a href="#cb72-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb72-496"><a href="#cb72-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;UC&quot;</span>, <span class="st">&quot;CD&quot;</span>)) <span class="sc">+</span></span>
<span id="cb72-497"><a href="#cb72-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">name =</span> <span class="st">&quot;Activity&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Reds&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-498"><a href="#cb72-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Activity Level&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb72-499"><a href="#cb72-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb72-500"><a href="#cb72-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb72-501"><a href="#cb72-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb72-502"><a href="#cb72-502" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">l =</span> <span class="dv">20</span>),</span>
<span id="cb72-503"><a href="#cb72-503" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb72-504"><a href="#cb72-504" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-505"><a href="#cb72-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-506"><a href="#cb72-506" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_list$bar</span></span>
<span id="cb72-507"><a href="#cb72-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-508"><a href="#cb72-508" aria-hidden="true" tabindex="-1"></a><span class="co"># assemble with patchwork</span></span>
<span id="cb72-509"><a href="#cb72-509" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(</span>
<span id="cb72-510"><a href="#cb72-510" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> plot_list<span class="sc">$</span>box, <span class="at">C =</span> plot_list<span class="sc">$</span>bar,</span>
<span id="cb72-511"><a href="#cb72-511" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> plot_list<span class="sc">$</span>pie, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>,</span>
<span id="cb72-512"><a href="#cb72-512" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span></span>
<span id="cb72-513"><a href="#cb72-513" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;AAC</span></span>
<span id="cb72-514"><a href="#cb72-514" aria-hidden="true" tabindex="-1"></a><span class="st"> AAC</span></span>
<span id="cb72-515"><a href="#cb72-515" aria-hidden="true" tabindex="-1"></a><span class="st"> BBC</span></span>
<span id="cb72-516"><a href="#cb72-516" aria-hidden="true" tabindex="-1"></a><span class="st"> BBC</span></span>
<span id="cb72-517"><a href="#cb72-517" aria-hidden="true" tabindex="-1"></a><span class="st"> BBC&quot;</span></span>
<span id="cb72-518"><a href="#cb72-518" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-519"><a href="#cb72-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-520"><a href="#cb72-520" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-521"><a href="#cb72-521" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-522"><a href="#cb72-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-523"><a href="#cb72-523" aria-hidden="true" tabindex="-1"></a><span class="fu">## Joining data ğŸŸ§+ï¸ğŸŸª {#joining-dataframes}</span></span>
<span id="cb72-524"><a href="#cb72-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-525"><a href="#cb72-525" aria-hidden="true" tabindex="-1"></a>Often, your data are not all in one table. For example, there were two sheets of data in the metadata Excel file, which we stored in the dataframe objects <span class="in">`meta`</span> and <span class="in">`meds`</span></span>
<span id="cb72-526"><a href="#cb72-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-527"><a href="#cb72-527" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-528"><a href="#cb72-528" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **meta**</span></span>
<span id="cb72-529"><a href="#cb72-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-530"><a href="#cb72-530" aria-hidden="true" tabindex="-1"></a>The main dataframe <span class="in">`meta`</span> contains most of the data about each patient:</span>
<span id="cb72-531"><a href="#cb72-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-532"><a href="#cb72-532" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-533"><a href="#cb72-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-534"><a href="#cb72-534" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-535"><a href="#cb72-535" aria-hidden="true" tabindex="-1"></a>meta</span>
<span id="cb72-536"><a href="#cb72-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-537"><a href="#cb72-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-538"><a href="#cb72-538" aria-hidden="true" tabindex="-1"></a><span class="fu">#### **meds**</span></span>
<span id="cb72-539"><a href="#cb72-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-540"><a href="#cb72-540" aria-hidden="true" tabindex="-1"></a>The second dataframe <span class="in">`meds`</span> contains medications info for the IBD cases:</span>
<span id="cb72-541"><a href="#cb72-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-542"><a href="#cb72-542" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-543"><a href="#cb72-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-544"><a href="#cb72-544" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-545"><a href="#cb72-545" aria-hidden="true" tabindex="-1"></a>meds</span>
<span id="cb72-546"><a href="#cb72-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-547"><a href="#cb72-547" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-548"><a href="#cb72-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-549"><a href="#cb72-549" aria-hidden="true" tabindex="-1"></a><span class="in">`dplyr`</span> provides functions to &quot;join&quot; dataframes together, using shared variables.</span>
<span id="cb72-550"><a href="#cb72-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-551"><a href="#cb72-551" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-552"><a href="#cb72-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-553"><a href="#cb72-553" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-554"><a href="#cb72-554" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(meta, meds)</span>
<span id="cb72-555"><a href="#cb72-555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-556"><a href="#cb72-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-557"><a href="#cb72-557" aria-hidden="true" tabindex="-1"></a>By default the join function will perform a &quot;natural&quot; join using all shared variables. For greater control you can specify a &quot;key&quot; variable, or set of variables, that should be used.</span>
<span id="cb72-558"><a href="#cb72-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-559"><a href="#cb72-559" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-560"><a href="#cb72-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-561"><a href="#cb72-561" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-562"><a href="#cb72-562" aria-hidden="true" tabindex="-1"></a><span class="co"># this should do the same thing as the natural join shown above</span></span>
<span id="cb72-563"><a href="#cb72-563" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> <span class="fu">left_join</span>(meta, meds, <span class="at">by =</span> <span class="fu">join_by</span>(ID, diagnosis))</span>
<span id="cb72-564"><a href="#cb72-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-565"><a href="#cb72-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-566"><a href="#cb72-566" aria-hidden="true" tabindex="-1"></a>What happened with the Control group? (remember they were not present in <span class="in">`meds`</span>!)</span>
<span id="cb72-567"><a href="#cb72-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-568"><a href="#cb72-568" aria-hidden="true" tabindex="-1"></a>Inspect the <span class="in">`all_meta`</span> dataframe to find out! e.g. <span class="in">`View(all_meta)`</span></span>
<span id="cb72-569"><a href="#cb72-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-570"><a href="#cb72-570" aria-hidden="true" tabindex="-1"></a>::: {#tip-joins .callout-tip collapse=&quot;true&quot;}</span>
<span id="cb72-571"><a href="#cb72-571" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learn the ways of the join ğŸª„</span></span>
<span id="cb72-572"><a href="#cb72-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-573"><a href="#cb72-573" aria-hidden="true" tabindex="-1"></a>A natural left join is the most common join you will need.</span>
<span id="cb72-574"><a href="#cb72-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-575"><a href="#cb72-575" aria-hidden="true" tabindex="-1"></a><span class="al">![](https://r4ds.hadley.nz/diagrams/join/left.png)</span>{width=&quot;500&quot;}</span>
<span id="cb72-576"><a href="#cb72-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-577"><a href="#cb72-577" aria-hidden="true" tabindex="-1"></a>But there are many other useful possibilities, e.g.</span>
<span id="cb72-578"><a href="#cb72-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-579"><a href="#cb72-579" aria-hidden="true" tabindex="-1"></a><span class="al">![](https://r4ds.hadley.nz/diagrams/join/venn.png)</span>{width=&quot;500&quot;}</span>
<span id="cb72-580"><a href="#cb72-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-581"><a href="#cb72-581" aria-hidden="true" tabindex="-1"></a>Learn more at:</span>
<span id="cb72-582"><a href="#cb72-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-583"><a href="#cb72-583" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This R4DS <span class="co">[</span><span class="ot">online book chapter</span><span class="co">](https://r4ds.hadley.nz/joins)</span>{target=&quot;_blank&quot;}</span>
<span id="cb72-584"><a href="#cb72-584" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This dplyr <span class="co">[</span><span class="ot">website article</span><span class="co">](https://dplyr.tidyverse.org/articles/two-table.html)</span>{target=&quot;_blank&quot;}</span>
<span id="cb72-585"><a href="#cb72-585" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-586"><a href="#cb72-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-587"><a href="#cb72-587" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mutating data ğŸ§¬? {#mutating-data}</span></span>
<span id="cb72-588"><a href="#cb72-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-589"><a href="#cb72-589" aria-hidden="true" tabindex="-1"></a>Often, you need to modify your variables, or create new ones.</span>
<span id="cb72-590"><a href="#cb72-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-591"><a href="#cb72-591" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modify and assign</span></span>
<span id="cb72-592"><a href="#cb72-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-593"><a href="#cb72-593" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Apply a function/transformation to an existing variable (or multiple variables).</span>
<span id="cb72-594"><a href="#cb72-594" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Assign the result to a new variable, or overwrite the original variable.</span>
<span id="cb72-595"><a href="#cb72-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-596"><a href="#cb72-596" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-597"><a href="#cb72-597" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Base R ğŸ¤–</span></span>
<span id="cb72-598"><a href="#cb72-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-599"><a href="#cb72-599" aria-hidden="true" tabindex="-1"></a>For simple transformations you can easily do this with base R.</span>
<span id="cb72-600"><a href="#cb72-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-601"><a href="#cb72-601" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-602"><a href="#cb72-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-603"><a href="#cb72-603" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-604"><a href="#cb72-604" aria-hidden="true" tabindex="-1"></a><span class="co"># create a logical variable, TRUE if patient has family history of IBD</span></span>
<span id="cb72-605"><a href="#cb72-605" aria-hidden="true" tabindex="-1"></a>all_meta<span class="sc">$</span>ibd_fhx <span class="ot">&lt;-</span> all_meta<span class="sc">$</span>family_history <span class="sc">==</span> <span class="st">&quot;fhx&quot;</span></span>
<span id="cb72-606"><a href="#cb72-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-607"><a href="#cb72-607" aria-hidden="true" tabindex="-1"></a><span class="co"># always check the result is what you expected!</span></span>
<span id="cb72-608"><a href="#cb72-608" aria-hidden="true" tabindex="-1"></a>all_meta[, <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;family_history&quot;</span>, <span class="st">&quot;ibd_fhx&quot;</span>)]</span>
<span id="cb72-609"><a href="#cb72-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-610"><a href="#cb72-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-611"><a href="#cb72-611" aria-hidden="true" tabindex="-1"></a><span class="fu">#### dplyr::mutate ğŸ‘½</span></span>
<span id="cb72-612"><a href="#cb72-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-613"><a href="#cb72-613" aria-hidden="true" tabindex="-1"></a>The <span class="in">`mutate`</span> function from dplyr is great for making multiple or complex transformations. You refer to variables without repeating the name of the dataframe. It is as if you are working &quot;inside&quot; the dataframe.</span>
<span id="cb72-614"><a href="#cb72-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-615"><a href="#cb72-615" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-616"><a href="#cb72-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-617"><a href="#cb72-617" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-618"><a href="#cb72-618" aria-hidden="true" tabindex="-1"></a><span class="co"># this is equivalent to the previous block</span></span>
<span id="cb72-619"><a href="#cb72-619" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ibd_fhx =</span> family_history <span class="sc">==</span> <span class="st">&quot;fhx&quot;</span>)</span>
<span id="cb72-620"><a href="#cb72-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-621"><a href="#cb72-621" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result again</span></span>
<span id="cb72-622"><a href="#cb72-622" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, family_history, ibd_fhx)</span>
<span id="cb72-623"><a href="#cb72-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-624"><a href="#cb72-624" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-625"><a href="#cb72-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-626"><a href="#cb72-626" aria-hidden="true" tabindex="-1"></a><span class="fu">### Temporary or persistent?</span></span>
<span id="cb72-627"><a href="#cb72-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-628"><a href="#cb72-628" aria-hidden="true" tabindex="-1"></a>We can convert character string variables to factor variables to specify an ordering of their levels (e.g. for plotting).</span>
<span id="cb72-629"><a href="#cb72-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-630"><a href="#cb72-630" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb72-631"><a href="#cb72-631" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Temporary âš¡</span></span>
<span id="cb72-632"><a href="#cb72-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-633"><a href="#cb72-633" aria-hidden="true" tabindex="-1"></a>You can temporarily mutate a dataframe and use the result. This is easy with pipes.</span>
<span id="cb72-634"><a href="#cb72-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-635"><a href="#cb72-635" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-636"><a href="#cb72-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-637"><a href="#cb72-637" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-638"><a href="#cb72-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb72-639"><a href="#cb72-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb72-640"><a href="#cb72-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-641"><a href="#cb72-641" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span></span>
<span id="cb72-642"><a href="#cb72-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diagnosis =</span> <span class="fu">factor</span>(diagnosis, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;CD&quot;</span>, <span class="st">&quot;UC&quot;</span>, <span class="st">&quot;Other&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb72-643"><a href="#cb72-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(diagnosis, age_years)) <span class="sc">+</span></span>
<span id="cb72-644"><a href="#cb72-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb72-645"><a href="#cb72-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-646"><a href="#cb72-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-647"><a href="#cb72-647" aria-hidden="true" tabindex="-1"></a>Notice this did NOT persistently modify the diagnosis variable, it is still &quot;character&quot; class.</span>
<span id="cb72-648"><a href="#cb72-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-649"><a href="#cb72-649" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-650"><a href="#cb72-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-651"><a href="#cb72-651" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-652"><a href="#cb72-652" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(all_meta<span class="sc">$</span>diagnosis) <span class="co"># no persistent changes, diagnosis is still character!</span></span>
<span id="cb72-653"><a href="#cb72-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-654"><a href="#cb72-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-655"><a href="#cb72-655" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Persistent ğŸª¨</span></span>
<span id="cb72-656"><a href="#cb72-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-657"><a href="#cb72-657" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate`</span> returns a modified dataframe and you must assign this to an object for changes to persist.</span>
<span id="cb72-658"><a href="#cb72-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-659"><a href="#cb72-659" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-660"><a href="#cb72-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-661"><a href="#cb72-661" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-662"><a href="#cb72-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb72-663"><a href="#cb72-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb72-664"><a href="#cb72-664" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">diagnosis =</span> <span class="fu">factor</span>(diagnosis, <span class="fu">c</span>(<span class="st">&quot;CD&quot;</span>, <span class="st">&quot;UC&quot;</span>, <span class="st">&quot;Other&quot;</span>)))</span>
<span id="cb72-665"><a href="#cb72-665" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(diagnosis, age_years)) <span class="sc">+</span></span>
<span id="cb72-666"><a href="#cb72-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb72-667"><a href="#cb72-667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-668"><a href="#cb72-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-669"><a href="#cb72-669" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-670"><a href="#cb72-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-671"><a href="#cb72-671" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-672"><a href="#cb72-672" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(all_meta<span class="sc">$</span>diagnosis)</span>
<span id="cb72-673"><a href="#cb72-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-674"><a href="#cb72-674" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-675"><a href="#cb72-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-676"><a href="#cb72-676" aria-hidden="true" tabindex="-1"></a><span class="fu">### More mutation</span></span>
<span id="cb72-677"><a href="#cb72-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-678"><a href="#cb72-678" aria-hidden="true" tabindex="-1"></a>We need to clean up the medication history.</span>
<span id="cb72-679"><a href="#cb72-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-680"><a href="#cb72-680" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-681"><a href="#cb72-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-682"><a href="#cb72-682" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-683"><a href="#cb72-683" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(all_meta<span class="sc">$</span>medication, <span class="at">useNA =</span> <span class="st">&quot;if&quot;</span>)</span>
<span id="cb72-684"><a href="#cb72-684" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(all_meta<span class="sc">$</span>immunosuppression_level, <span class="at">useNA =</span> <span class="st">&quot;if&quot;</span>)</span>
<span id="cb72-685"><a href="#cb72-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-686"><a href="#cb72-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-687"><a href="#cb72-687" aria-hidden="true" tabindex="-1"></a>We have NAs for the medication for all the Controls. We know they had &quot;none&quot;, so let&#39;s first indicate that. We will also replace Controls&#39; immunosuppression_level NA values with &quot;none&quot;.</span>
<span id="cb72-688"><a href="#cb72-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-689"><a href="#cb72-689" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-690"><a href="#cb72-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-691"><a href="#cb72-691" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-692"><a href="#cb72-692" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb72-693"><a href="#cb72-693" aria-hidden="true" tabindex="-1"></a>  <span class="at">medication =</span> <span class="fu">if_else</span>(case_control <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, <span class="at">true =</span> <span class="st">&quot;none&quot;</span>, <span class="at">false =</span> medication),</span>
<span id="cb72-694"><a href="#cb72-694" aria-hidden="true" tabindex="-1"></a>  <span class="at">immunosuppression_level =</span> <span class="fu">if_else</span>(case_control <span class="sc">==</span> <span class="st">&quot;Control&quot;</span>, <span class="at">true =</span> <span class="st">&quot;none&quot;</span>, <span class="at">false =</span> immunosuppression_level)</span>
<span id="cb72-695"><a href="#cb72-695" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-696"><a href="#cb72-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-697"><a href="#cb72-697" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result!</span></span>
<span id="cb72-698"><a href="#cb72-698" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, case_control, medication, immunosuppression_level)</span>
<span id="cb72-699"><a href="#cb72-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-700"><a href="#cb72-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-701"><a href="#cb72-701" aria-hidden="true" tabindex="-1"></a>We now want logical variables indicating if the patient recently had antibiotics (abx), steroids, or other immunosuppressive drugs (imsp).</span>
<span id="cb72-702"><a href="#cb72-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-703"><a href="#cb72-703" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-704"><a href="#cb72-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-705"><a href="#cb72-705" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-706"><a href="#cb72-706" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb72-707"><a href="#cb72-707" aria-hidden="true" tabindex="-1"></a>  <span class="at">abx =</span> <span class="fu">str_detect</span>(medication, <span class="st">&quot;abx&quot;</span>),</span>
<span id="cb72-708"><a href="#cb72-708" aria-hidden="true" tabindex="-1"></a>  <span class="at">steroids =</span> <span class="fu">str_detect</span>(medication, <span class="st">&quot;steroids&quot;</span>),</span>
<span id="cb72-709"><a href="#cb72-709" aria-hidden="true" tabindex="-1"></a>  <span class="at">imsp_other =</span> <span class="fu">str_detect</span>(medication, <span class="st">&quot;imsp&quot;</span>),</span>
<span id="cb72-710"><a href="#cb72-710" aria-hidden="true" tabindex="-1"></a>  <span class="at">imsp_any =</span> steroids <span class="sc">|</span> imsp_other</span>
<span id="cb72-711"><a href="#cb72-711" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-712"><a href="#cb72-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-713"><a href="#cb72-713" aria-hidden="true" tabindex="-1"></a><span class="co"># check the result!</span></span>
<span id="cb72-714"><a href="#cb72-714" aria-hidden="true" tabindex="-1"></a><span class="co"># all_meta %&gt;% select(case_control, medication, abx, steroids, imsp_other, imsp_any)</span></span>
<span id="cb72-715"><a href="#cb72-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-716"><a href="#cb72-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-717"><a href="#cb72-717" aria-hidden="true" tabindex="-1"></a>For the character variables with more than two values, we can convert them to factors, to encode our preferred ordering of their levels.</span>
<span id="cb72-718"><a href="#cb72-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-719"><a href="#cb72-719" aria-hidden="true" tabindex="-1"></a>In R stats methods, the 1st level of a factor is often used as the reference level by default. So we should keep this in mind, and typically set control levels as the 1st factor level. We can always temporarily change this for plots.</span>
<span id="cb72-720"><a href="#cb72-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-721"><a href="#cb72-721" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-722"><a href="#cb72-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-723"><a href="#cb72-723" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-724"><a href="#cb72-724" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb72-725"><a href="#cb72-725" aria-hidden="true" tabindex="-1"></a>  <span class="at">diagnosis =</span> <span class="fu">factor</span>(diagnosis, <span class="fu">c</span>(<span class="st">&quot;Other&quot;</span>, <span class="st">&quot;CD&quot;</span>, <span class="st">&quot;UC&quot;</span>)),</span>
<span id="cb72-726"><a href="#cb72-726" aria-hidden="true" tabindex="-1"></a>  <span class="at">active =</span> <span class="fu">factor</span>(active, <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;inactive&quot;</span>, <span class="st">&quot;active&quot;</span>)),</span>
<span id="cb72-727"><a href="#cb72-727" aria-hidden="true" tabindex="-1"></a>  <span class="at">activity =</span> <span class="fu">factor</span>(activity, <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;inactive&quot;</span>, <span class="st">&quot;mild&quot;</span>, <span class="st">&quot;moderate&quot;</span>, <span class="st">&quot;severe&quot;</span>))</span>
<span id="cb72-728"><a href="#cb72-728" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-729"><a href="#cb72-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-730"><a href="#cb72-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-731"><a href="#cb72-731" aria-hidden="true" tabindex="-1"></a>Now you do the same for <span class="in">`immunosuppression_level`</span>! Don&#39;t forget to check the result</span>
<span id="cb72-732"><a href="#cb72-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-733"><a href="#cb72-733" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse=&quot;true&quot;}</span>
<span id="cb72-734"><a href="#cb72-734" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Click for solution</span></span>
<span id="cb72-735"><a href="#cb72-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-736"><a href="#cb72-736" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-737"><a href="#cb72-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-738"><a href="#cb72-738" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-739"><a href="#cb72-739" aria-hidden="true" tabindex="-1"></a>all_meta <span class="ot">&lt;-</span> all_meta <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb72-740"><a href="#cb72-740" aria-hidden="true" tabindex="-1"></a>  <span class="at">immunosuppression_level =</span> <span class="fu">factor</span>(<span class="at">x =</span> immunosuppression_level, <span class="fu">c</span>(</span>
<span id="cb72-741"><a href="#cb72-741" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;none&quot;</span>, <span class="st">&quot;level0&quot;</span>, <span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>, <span class="st">&quot;level4&quot;</span></span>
<span id="cb72-742"><a href="#cb72-742" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb72-743"><a href="#cb72-743" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-744"><a href="#cb72-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-745"><a href="#cb72-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-746"><a href="#cb72-746" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-747"><a href="#cb72-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-748"><a href="#cb72-748" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-749"><a href="#cb72-749" aria-hidden="true" tabindex="-1"></a>all_meta <span class="sc">%&gt;%</span> <span class="fu">select</span>(diagnosis, activity, immunosuppression_level)</span>
<span id="cb72-750"><a href="#cb72-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-751"><a href="#cb72-751" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb72-752"><a href="#cb72-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-753"><a href="#cb72-753" aria-hidden="true" tabindex="-1"></a><span class="fu">## Save your progress ğŸ’¾</span></span>
<span id="cb72-754"><a href="#cb72-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-755"><a href="#cb72-755" aria-hidden="true" tabindex="-1"></a>Let&#39;s save the <span class="in">`all_meta`</span> dataframe in three formats: Excel, CSV, and RDS, all within a folder called &quot;processed&quot; inside the &quot;data&quot; folder.</span>
<span id="cb72-756"><a href="#cb72-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-757"><a href="#cb72-757" aria-hidden="true" tabindex="-1"></a>First, we&#39;ll create the &quot;processed&quot; directory.</span>
<span id="cb72-758"><a href="#cb72-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-759"><a href="#cb72-759" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-760"><a href="#cb72-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-761"><a href="#cb72-761" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-762"><a href="#cb72-762" aria-hidden="true" tabindex="-1"></a>output_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;papa2012&quot;</span>, <span class="st">&quot;processed&quot;</span>)</span>
<span id="cb72-763"><a href="#cb72-763" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(output_path)</span>
<span id="cb72-764"><a href="#cb72-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-765"><a href="#cb72-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-766"><a href="#cb72-766" aria-hidden="true" tabindex="-1"></a>Then we write an excel file, using the <span class="in">`write_xlsx`</span> function from the <span class="in">`writexl`</span> package.</span>
<span id="cb72-767"><a href="#cb72-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-768"><a href="#cb72-768" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-769"><a href="#cb72-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-770"><a href="#cb72-770" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-771"><a href="#cb72-771" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;all_metadata.xlsx&quot;</span>))</span>
<span id="cb72-772"><a href="#cb72-772" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-773"><a href="#cb72-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-774"><a href="#cb72-774" aria-hidden="true" tabindex="-1"></a>CSV files are a common format for storing tabular data. We use the <span class="in">`write_csv`</span> function from the <span class="in">`readr`</span> package.</span>
<span id="cb72-775"><a href="#cb72-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-776"><a href="#cb72-776" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-777"><a href="#cb72-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-778"><a href="#cb72-778" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-779"><a href="#cb72-779" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;all_metadata.csv&quot;</span>))</span>
<span id="cb72-780"><a href="#cb72-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-781"><a href="#cb72-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-782"><a href="#cb72-782" aria-hidden="true" tabindex="-1"></a>RDS files are R&#39;s native format for saving single R objects. They preserve data types and structures, making them ideal for saving and loading a variety of R objects.</span>
<span id="cb72-783"><a href="#cb72-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-784"><a href="#cb72-784" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-785"><a href="#cb72-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-786"><a href="#cb72-786" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-787"><a href="#cb72-787" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;all_metadata.rds&quot;</span>))</span>
<span id="cb72-788"><a href="#cb72-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-789"><a href="#cb72-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-790"><a href="#cb72-790" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-791"><a href="#cb72-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-792"><a href="#cb72-792" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-793"><a href="#cb72-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb72-794"><a href="#cb72-794" aria-hidden="true" tabindex="-1"></a><span class="co"># these files can be used if participants fail to replicate processing</span></span>
<span id="cb72-795"><a href="#cb72-795" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">here</span>(output_path, <span class="st">&quot;backup&quot;</span>))</span>
<span id="cb72-796"><a href="#cb72-796" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;backup&quot;</span>, <span class="st">&quot;all_metadata.csv&quot;</span>))</span>
<span id="cb72-797"><a href="#cb72-797" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(all_meta, <span class="fu">here</span>(output_path, <span class="st">&quot;backup&quot;</span>, <span class="st">&quot;all_metadata.xlsx&quot;</span>))</span>
<span id="cb72-798"><a href="#cb72-798" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(all_meta, <span class="at">file =</span> <span class="fu">here</span>(output_path, <span class="st">&quot;backup&quot;</span>, <span class="st">&quot;all_metadata.rds&quot;</span>))</span>
<span id="cb72-799"><a href="#cb72-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-800"><a href="#cb72-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-801"><a href="#cb72-801" aria-hidden="true" tabindex="-1"></a><span class="fu">## Next! â©</span></span>
<span id="cb72-802"><a href="#cb72-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-803"><a href="#cb72-803" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We have recapped some R fundamentals and introduced the sample metadata.</span>
<span id="cb72-804"><a href="#cb72-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-805"><a href="#cb72-805" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Next we will start working with microbiome data!</span>
<span id="cb72-806"><a href="#cb72-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-807"><a href="#cb72-807" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Click here: <span class="ot">&lt;https://david-barnett.github.io/Liege-microbiome/practical-1/web/practical1B-instructions.html&gt;</span></span>
<span id="cb72-808"><a href="#cb72-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-809"><a href="#cb72-809" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session info</span></span>
<span id="cb72-810"><a href="#cb72-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-811"><a href="#cb72-811" aria-hidden="true" tabindex="-1"></a>For reproducibility, it is useful to record the packages and versions used in your analyses. This is easy to do with <span class="in">`sessioninfo::session_info()`</span>.</span>
<span id="cb72-812"><a href="#cb72-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-813"><a href="#cb72-813" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb72-814"><a href="#cb72-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-815"><a href="#cb72-815" aria-hidden="true" tabindex="-1"></a>quarto-executable-code-5450563D</span>
<span id="cb72-816"><a href="#cb72-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-817"><a href="#cb72-817" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb72-818"><a href="#cb72-818" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb72-819"><a href="#cb72-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb72-820"><a href="#cb72-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-821"><a href="#cb72-821" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span></code></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","loop":false,"closeEffect":"zoom","openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>

</body>

</html>
